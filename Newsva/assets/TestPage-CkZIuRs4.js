import{K as E,N as K,b as N,a as U}from"./KeywordView-DcApNL0m.js";import{p as V,a9 as L,aa as R,r as i,q as I,I as p,P as c,D as w,u as t,a2 as T,G as B,C as h,t as m}from"./index-Dutiedfx.js";const A=V({__name:"TestPage",setup(G){const l=L(),n=R(),u=i(window.innerWidth),s=i(window.innerHeight),x=i(parseFloat(getComputedStyle(document.documentElement).fontSize)),F=()=>{x.value=parseFloat(getComputedStyle(document.documentElement).fontSize)};window.addEventListener("resize",()=>{u.value=window.innerWidth,s.value=window.innerHeight,F()});const d=computed(()=>[.2*u.value,.4*u.value,.4*u.value]),v=computed(()=>Array.from({length:d.value.length},(e,a)=>d.value.slice(0,a).reduce((r,y)=>r+y,0))),S=computed(()=>l.data.filter(n.coordinateFilter)),g=computed(()=>l.data.filter(e=>n.timeFilter(e)&&n.topicFilter(e))),f=computed(()=>g.value.filter(e=>n.coordinateFilter(e))),k=computed(()=>{const e=new Map;return f.value.forEach(a=>{a.keywords.forEach(r=>{e.has(r)?e.set(r,e.get(r)+1):e.set(r,1)})}),Array.from(e.entries()).sort((a,r)=>r[1]-a[1]).map((a,r)=>({id:r,label:a[0],values:[a[1]]}))}),P=computed(()=>l.eras.map(e=>({label:e.name,start:new Date(e.start.year,e.start.month-1,e.start.day),end:new Date(e.end.year,e.end.month-1,e.end.day)}))),D=computed(()=>l.eras.flatMap(e=>e.sub_eras).map(e=>({label:e.name,start:new Date(e.start.year,e.start.month-1,e.start.day),end:new Date(e.end.year,e.end.month-1,e.end.day)}))),b=i([new Date(960,0,1),new Date(1280,0,1)]),_=i([new Date(960,0,1),new Date(1280,0,1)]);return i([new Date(960,0,1),new Date(1280,0,1)]),i([new Date(960,0,1),new Date(1280,0,1)]),i("basic"),i("basic"),(e,a)=>{const r=T("vue-draggable-resizable"),y=N,C=U;return m(),I("div",{style:B({width:`${u.value}px`,height:`${s.value}px`,position:"relative"})},[p(r,{w:t(d)[0],h:.46*s.value,x:t(v)[0],y:.08*s.value},{default:w(()=>[t(l).dataPrepared?(m(),h(E,{key:0,class:"component",width:"95%",height:"95%","bar-data":t(k),title:"关键词统计","lable-name":"关键词","value-name":"出现频次",unit:"（单位：次）","toggle-labels":[],"hover-keyword":t(n).hoverKeyword,"onUpdate:hoverKeyword":a[0]||(a[0]=o=>t(n).hoverKeyword=o)},null,8,["bar-data","hover-keyword"])):c("",!0)]),_:1},8,["w","h","x","y"]),p(r,{w:t(d)[0],h:.46*s.value,x:500,y:500},{default:w(()=>[t(l).dataPrepared?(m(),h(K,{key:0,style:{width:"100%"},dynastyList:t(P),eraList:t(D),width:"100%","event-list":t(D),"current-range":b.value,"onUpdate:currentRange":a[1]||(a[1]=o=>b.value=o),"select-range":_.value,"onUpdate:selectRange":a[2]||(a[2]=o=>_.value=o),"current-grain":t(n).timeGrainSelected,data:t(S),"quality-threshold":0,"hover-page-id":null,topics:t(l).topics},null,8,["dynastyList","eraList","event-list","current-range","select-range","current-grain","data","topics"])):c("",!0)]),_:1},8,["w","h"]),c("",!0),p(r,{w:t(d)[1],h:.46*s.value,x:t(v)[1],y:.08*s.value},{default:w(()=>[t(l).dataPrepared?(m(),h(y,{key:0,class:"component",style:{width:"100%",height:"100%"},data:t(f)},null,8,["data"])):c("",!0)]),_:1},8,["w","h","x","y"]),p(r,{w:t(d)[1],h:.46*s.value,x:t(v)[1],y:.54*s.value},{default:w(()=>[t(l).dataPrepared?(m(),h(C,{key:0,class:"component",style:{width:"100%",height:"100%"},data:t(g),"embedding-list":t(l).embeddings.map((o,z)=>({name:o,idx:z})),"hover-keyword":t(n).hoverKeyword,"hover-page-i-d":t(n).hoverPageID,"onUpdate:hoverPageID":a[7]||(a[7]=o=>t(n).hoverPageID=o),"coordinate-filter":t(n).coordinateFilter,"onUpdate:coordinateFilter":a[8]||(a[8]=o=>t(n).coordinateFilter=o)},null,8,["data","embedding-list","hover-keyword","hover-page-i-d","coordinate-filter"])):c("",!0)]),_:1},8,["w","h","x","y"])],4)}}});export{A as default};
