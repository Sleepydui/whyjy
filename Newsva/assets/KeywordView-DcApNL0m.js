import{ag as an,ah as ha,ai as ut,aj as da,ak as Vn,al as Mr,am as ma,an as xr,ao as $i,ap as Ge,aq as qe,ar as Ke,as as Qe,at as Tn,p as De,r as et,aa as ga,c as q,au as kr,ac as Sn,e as Ee,B as ze,q as J,y as S,E as ce,C as Bn,P as Lt,J as Dt,a4 as Et,H as jn,u as bt,Z as lt,av as va,D as re,a7 as pa,a2 as ya,F as Zt,I as Xe,_ as Ze,aw as wa,n as Gn,ad as Fe,ae as Re,t as Z,f as zt,O as ba,G as Gt,v as $r,ax as Le,a5 as qn,ay as Tr,az as _a,aA as Ma,aB as xa,aC as ka,aD as $a,aE as Sr,aF as Cr,aG as Dr,a3 as Ta,aH as Sa,aI as Ca}from"./index-Dutiedfx.js";function Da(t,e){return t==null||e==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function dr(t){let e,n,r;t.length!==2?(e=an,n=(u,l)=>an(t(u),l),r=(u,l)=>t(u)-l):(e=t===an||t===Da?t:Ea,n=t,r=t);function i(u,l,s=0,h=u.length){if(s<h){if(e(l,l)!==0)return h;do{const c=s+h>>>1;n(u[c],l)<0?s=c+1:h=c}while(s<h)}return s}function o(u,l,s=0,h=u.length){if(s<h){if(e(l,l)!==0)return h;do{const c=s+h>>>1;n(u[c],l)<=0?s=c+1:h=c}while(s<h)}return s}function a(u,l,s=0,h=u.length){const c=i(u,l,s,h-1);return c>s&&r(u[c-1],l)>-r(u[c],l)?c-1:c}return{left:i,center:a,right:o}}function Ea(){return 0}const za=dr(an),Fa=za.right;dr(ha).center;const Ra=Ua(Aa);function Ua(t){return function(e,n,r=n){if(!((n=+n)>=0))throw new RangeError("invalid rx");if(!((r=+r)>=0))throw new RangeError("invalid ry");let{data:i,width:o,height:a}=e;if(!((o=Math.floor(o))>=0))throw new RangeError("invalid width");if(!((a=Math.floor(a!==void 0?a:i.length/o))>=0))throw new RangeError("invalid height");if(!o||!a||!n&&!r)return e;const u=n&&t(n),l=r&&t(r),s=i.slice();return u&&l?(ge(u,s,i,o,a),ge(u,i,s,o,a),ge(u,s,i,o,a),ve(l,i,s,o,a),ve(l,s,i,o,a),ve(l,i,s,o,a)):u?(ge(u,i,s,o,a),ge(u,s,i,o,a),ge(u,i,s,o,a)):l&&(ve(l,i,s,o,a),ve(l,s,i,o,a),ve(l,i,s,o,a)),e}}function ge(t,e,n,r,i){for(let o=0,a=r*i;o<a;)t(e,n,o,o+=r,1)}function ve(t,e,n,r,i){for(let o=0,a=r*i;o<r;++o)t(e,n,o,o+a,r)}function Aa(t){const e=Math.floor(t);if(e===t)return Na(t);const n=t-e,r=2*t+1;return(i,o,a,u,l)=>{if(!((u-=l)>=a))return;let s=e*o[a];const h=l*e,c=h+l;for(let f=a,_=a+h;f<_;f+=l)s+=o[Math.min(u,f)];for(let f=a,_=u;f<=_;f+=l)s+=o[Math.min(u,f+h)],i[f]=(s+n*(o[Math.max(a,f-c)]+o[Math.min(u,f+c)]))/r,s-=o[Math.max(a,f-h)]}}function Na(t){const e=2*t+1;return(n,r,i,o,a)=>{if(!((o-=a)>=i))return;let u=t*r[i];const l=a*t;for(let s=i,h=i+l;s<h;s+=a)u+=r[Math.min(o,s)];for(let s=i,h=o;s<=h;s+=a)u+=r[Math.min(o,s+l)],n[s]=u/e,u-=r[Math.max(i,s-l)]}}function La(t,e){let n=0;for(let r of t)r!=null&&(r=+r)>=r&&++n;return n}function Ia(t,e){var n=0;return Float64Array.from(t,r=>n+=+r||0)}class xe{constructor(){this._partials=new Float64Array(32),this._n=0}add(e){const n=this._partials;let r=0;for(let i=0;i<this._n&&i<32;i++){const o=n[i],a=e+o,u=Math.abs(e)<Math.abs(o)?e-(a-o):o-(a-e);u&&(n[r++]=u),e=a}return n[r]=e,this._n=r+1,this}valueOf(){const e=this._partials;let n=this._n,r,i,o,a=0;if(n>0){for(a=e[--n];n>0&&(r=a,i=e[--n],a=r+i,o=i-(a-r),!o););n>0&&(o<0&&e[n-1]<0||o>0&&e[n-1]>0)&&(i=o*2,r=a+i,i==r-a&&(a=r))}return a}}class Oa extends Map{constructor(e,n=Wa){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),e!=null)for(const[r,i]of e)this.set(r,i)}get(e){return super.get(Er(this,e))}has(e){return super.has(Er(this,e))}set(e,n){return super.set(Ya(this,e),n)}delete(e){return super.delete(Pa(this,e))}}function Er({_intern:t,_key:e},n){const r=e(n);return t.has(r)?t.get(r):n}function Ya({_intern:t,_key:e},n){const r=e(n);return t.has(r)?t.get(r):(t.set(r,n),n)}function Pa({_intern:t,_key:e},n){const r=e(n);return t.has(r)&&(n=t.get(r),t.delete(r)),n}function Wa(t){return t!==null&&typeof t=="object"?t.valueOf():t}function Ha(t){return t}function zr(t,e,...n){return Va(t,Ha,e,n)}function Va(t,e,n,r){return function i(o,a){if(a>=r.length)return n(o);const u=new Oa,l=r[a++];let s=-1;for(const h of o){const c=l(h,++s,o),f=u.get(c);f?f.push(h):u.set(c,[h])}for(const[h,c]of u)u.set(h,i(c,a));return e(u)}(t,0)}const Ba=Math.sqrt(50),ja=Math.sqrt(10),Ga=Math.sqrt(2);function un(t,e,n){const r=(e-t)/Math.max(0,n),i=Math.floor(Math.log10(r)),o=r/Math.pow(10,i),a=o>=Ba?10:o>=ja?5:o>=Ga?2:1;let u,l,s;return i<0?(s=Math.pow(10,-i)/a,u=Math.round(t*s),l=Math.round(e*s),u/s<t&&++u,l/s>e&&--l,s=-s):(s=Math.pow(10,i)*a,u=Math.round(t/s),l=Math.round(e/s),u*s<t&&++u,l*s>e&&--l),l<u&&.5<=n&&n<2?un(t,e,n*2):[u,l,s]}function mr(t,e,n){if(e=+e,t=+t,n=+n,!(n>0))return[];if(t===e)return[t];const r=e<t,[i,o,a]=r?un(e,t,n):un(t,e,n);if(!(o>=i))return[];const u=o-i+1,l=new Array(u);if(r)if(a<0)for(let s=0;s<u;++s)l[s]=(o-s)/-a;else for(let s=0;s<u;++s)l[s]=(o-s)*a;else if(a<0)for(let s=0;s<u;++s)l[s]=(i+s)/-a;else for(let s=0;s<u;++s)l[s]=(i+s)*a;return l}function ln(t,e,n){return e=+e,t=+t,n=+n,un(t,e,n)[2]}function Xn(t,e,n){e=+e,t=+t,n=+n;const r=e<t,i=r?ln(e,t,n):ln(t,e,n);return(r?-1:1)*(i<0?1/-i:i)}function qa(t,e,n){let r;for(;;){const i=ln(t,e,n);if(i===r||i===0||!isFinite(i))return[t,e];i>0?(t=Math.floor(t/i)*i,e=Math.ceil(e/i)*i):i<0&&(t=Math.ceil(t*i)/i,e=Math.floor(e*i)/i),r=i}}function Xa(t){return Math.max(1,Math.ceil(Math.log(La(t))/Math.LN2)+1)}function Za(t){return t}var Ka=1,Fr=1e-6;function Qa(t){return"translate("+t+",0)"}function Ja(t){return e=>+t(e)}function to(t,e){return e=Math.max(0,t.bandwidth()-e*2)/2,t.round()&&(e=Math.round(e)),n=>+t(n)+e}function eo(){return!this.__axis}function no(t,e){var n=[],r=null,i=null,o=6,a=6,u=3,l=typeof window<"u"&&window.devicePixelRatio>1?0:.5,s=-1,h="y",c=Qa;function f(_){var E=r??(e.ticks?e.ticks.apply(e,n):e.domain()),W=i??(e.tickFormat?e.tickFormat.apply(e,n):Za),w=Math.max(o,0)+u,m=e.range(),p=+m[0]+l,g=+m[m.length-1]+l,C=(e.bandwidth?to:Ja)(e.copy(),l),z=_.selection?_.selection():_,T=z.selectAll(".domain").data([null]),H=z.selectAll(".tick").data(E,e).order(),B=H.exit(),M=H.enter().append("g").attr("class","tick"),b=H.select("line"),v=H.select("text");T=T.merge(T.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),H=H.merge(M),b=b.merge(M.append("line").attr("stroke","currentColor").attr(h+"2",s*o)),v=v.merge(M.append("text").attr("fill","currentColor").attr(h,s*w).attr("dy","0em")),_!==z&&(T=T.transition(_),H=H.transition(_),b=b.transition(_),v=v.transition(_),B=B.transition(_).attr("opacity",Fr).attr("transform",function(N){return isFinite(N=C(N))?c(N+l):this.getAttribute("transform")}),M.attr("opacity",Fr).attr("transform",function(N){var L=this.parentNode.__axis;return c((L&&isFinite(L=L(N))?L:C(N))+l)})),B.remove(),T.attr("d",a?"M"+p+","+s*a+"V"+l+"H"+g+"V"+s*a:"M"+p+","+l+"H"+g),H.attr("opacity",1).attr("transform",function(N){return c(C(N)+l)}),b.attr(h+"2",s*o),v.attr(h,s*w).text(W),z.filter(eo).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor","middle"),z.each(function(){this.__axis=C})}return f.scale=function(_){return arguments.length?(e=_,f):e},f.ticks=function(){return n=Array.from(arguments),f},f.tickArguments=function(_){return arguments.length?(n=_==null?[]:Array.from(_),f):n.slice()},f.tickValues=function(_){return arguments.length?(r=_==null?null:Array.from(_),f):r&&r.slice()},f.tickFormat=function(_){return arguments.length?(i=_,f):i},f.tickSize=function(_){return arguments.length?(o=a=+_,f):o},f.tickSizeInner=function(_){return arguments.length?(o=+_,f):o},f.tickSizeOuter=function(_){return arguments.length?(a=+_,f):a},f.tickPadding=function(_){return arguments.length?(u=+_,f):u},f.offset=function(_){return arguments.length?(l=+_,f):l},f}function ro(t){return no(Ka,t)}function io(t){let e;for(;e=t.sourceEvent;)t=e;return t}function At(t,e){if(t=io(t),e===void 0&&(e=t.currentTarget),e){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=t.clientX,r.y=t.clientY,r=r.matrixTransform(e.getScreenCTM().inverse()),[r.x,r.y]}if(e.getBoundingClientRect){var i=e.getBoundingClientRect();return[t.clientX-i.left-e.clientLeft,t.clientY-i.top-e.clientTop]}}return[t.pageX,t.pageY]}const Zn={capture:!0,passive:!1};function Kn(t){t.preventDefault(),t.stopImmediatePropagation()}function Ti(t){var e=t.document.documentElement,n=ut(t).on("dragstart.drag",Kn,Zn);"onselectstart"in e?n.on("selectstart.drag",Kn,Zn):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}function Si(t,e){var n=t.document.documentElement,r=ut(t).on("dragstart.drag",null);e&&(r.on("click.drag",Kn,Zn),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}function ao(t,e){e||(e=[]);var n=t?Math.min(e.length,t.length):0,r=e.slice(),i;return function(o){for(i=0;i<n;++i)r[i]=t[i]*(1-o)+e[i]*o;return r}}function oo(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function so(t,e){var n=e?e.length:0,r=t?Math.min(n,t.length):0,i=new Array(r),o=new Array(n),a;for(a=0;a<r;++a)i[a]=Mn(t[a],e[a]);for(;a<n;++a)o[a]=e[a];return function(u){for(a=0;a<r;++a)o[a]=i[a](u);return o}}function uo(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}}function lo(t,e){var n={},r={},i;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(i in e)i in t?n[i]=Mn(t[i],e[i]):r[i]=e[i];return function(o){for(i in n)r[i]=n[i](o);return r}}function Mn(t,e){var n=typeof e,r;return e==null||n==="boolean"?da(e):(n==="number"?Vn:n==="string"?(r=xr(e))?(e=r,Mr):ma:e instanceof xr?Mr:e instanceof Date?uo:oo(e)?ao:Array.isArray(e)?so:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?lo:Vn)(t,e)}function co(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}var fo=1e-12;function Rr(t){return((t=Math.exp(t))+1/t)/2}function ho(t){return((t=Math.exp(t))-1/t)/2}function mo(t){return((t=Math.exp(2*t))-1)/(t+1)}const go=function t(e,n,r){function i(o,a){var u=o[0],l=o[1],s=o[2],h=a[0],c=a[1],f=a[2],_=h-u,E=c-l,W=_*_+E*E,w,m;if(W<fo)m=Math.log(f/s)/e,w=function(H){return[u+H*_,l+H*E,s*Math.exp(e*H*m)]};else{var p=Math.sqrt(W),g=(f*f-s*s+r*W)/(2*s*n*p),C=(f*f-s*s-r*W)/(2*f*n*p),z=Math.log(Math.sqrt(g*g+1)-g),T=Math.log(Math.sqrt(C*C+1)-C);m=(T-z)/e,w=function(H){var B=H*m,M=Rr(z),b=s/(n*p)*(M*mo(e*B+z)-ho(z));return[u+b*_,l+b*E,s*M/Rr(e*B+z)]}}return w.duration=m*1e3*e/Math.SQRT2,w}return i.rho=function(o){var a=Math.max(.001,+o),u=a*a,l=u*u;return t(a,u,l)},i}(Math.SQRT2,2,4),Cn=t=>()=>t;function vo(t,{sourceEvent:e,target:n,selection:r,mode:i,dispatch:o}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},selection:{value:r,enumerable:!0,configurable:!0},mode:{value:i,enumerable:!0,configurable:!0},_:{value:o}})}function po(t){t.stopImmediatePropagation()}function Dn(t){t.preventDefault(),t.stopImmediatePropagation()}var Ur={name:"drag"},En={name:"space"},pe={name:"handle"},ye={name:"center"};const{abs:Ar,max:St,min:Ct}=Math;function Nr(t){return[+t[0],+t[1]]}function Lr(t){return[Nr(t[0]),Nr(t[1])]}var on={name:"x",handles:["w","e"].map(Qn),input:function(t,e){return t==null?null:[[+t[0],e[0][1]],[+t[1],e[1][1]]]},output:function(t){return t&&[t[0][0],t[1][0]]}},zn={},Ht={overlay:"crosshair",selection:"move",n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},Ir={e:"w",w:"e",nw:"ne",ne:"nw",se:"sw",sw:"se"},Or={n:"s",s:"n",nw:"sw",ne:"se",se:"ne",sw:"nw"},yo={overlay:1,selection:1,n:null,e:1,s:null,w:-1,nw:-1,ne:1,se:1,sw:-1},wo={overlay:1,selection:1,n:-1,e:null,s:1,w:null,nw:-1,ne:-1,se:1,sw:1};function Qn(t){return{type:t}}function bo(t){return!t.ctrlKey&&!t.button}function _o(){var t=this.ownerSVGElement||this;return t.hasAttribute("viewBox")?(t=t.viewBox.baseVal,[[t.x,t.y],[t.x+t.width,t.y+t.height]]):[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]}function Mo(){return navigator.maxTouchPoints||"ontouchstart"in this}function Fn(t){for(;!t.__brush;)if(!(t=t.parentNode))return;return t.__brush}function xo(t){return t[0][0]===t[1][0]||t[0][1]===t[1][1]}function ko(){return $o(on)}function $o(t){var e=_o,n=bo,r=Mo,i=!0,o=$i("start","brush","end"),a=6,u;function l(w){var m=w.property("__brush",W).selectAll(".overlay").data([Qn("overlay")]);m.enter().append("rect").attr("class","overlay").attr("pointer-events","all").attr("cursor",Ht.overlay).merge(m).each(function(){var g=Fn(this).extent;ut(this).attr("x",g[0][0]).attr("y",g[0][1]).attr("width",g[1][0]-g[0][0]).attr("height",g[1][1]-g[0][1])}),w.selectAll(".selection").data([Qn("selection")]).enter().append("rect").attr("class","selection").attr("cursor",Ht.selection).attr("fill","#777").attr("fill-opacity",.3).attr("stroke","#fff").attr("shape-rendering","crispEdges");var p=w.selectAll(".handle").data(t.handles,function(g){return g.type});p.exit().remove(),p.enter().append("rect").attr("class",function(g){return"handle handle--"+g.type}).attr("cursor",function(g){return Ht[g.type]}),w.each(s).attr("fill","none").attr("pointer-events","all").on("mousedown.brush",f).filter(r).on("touchstart.brush",f).on("touchmove.brush",_).on("touchend.brush touchcancel.brush",E).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}l.move=function(w,m,p){w.tween?w.on("start.brush",function(g){h(this,arguments).beforestart().start(g)}).on("interrupt.brush end.brush",function(g){h(this,arguments).end(g)}).tween("brush",function(){var g=this,C=g.__brush,z=h(g,arguments),T=C.selection,H=t.input(typeof m=="function"?m.apply(this,arguments):m,C.extent),B=Mn(T,H);function M(b){C.selection=b===1&&H===null?null:B(b),s.call(g),z.brush()}return T!==null&&H!==null?M:M(1)}):w.each(function(){var g=this,C=arguments,z=g.__brush,T=t.input(typeof m=="function"?m.apply(g,C):m,z.extent),H=h(g,C).beforestart();Ge(g),z.selection=T===null?null:T,s.call(g),H.start(p).brush(p).end(p)})},l.clear=function(w,m){l.move(w,null,m)};function s(){var w=ut(this),m=Fn(this).selection;m?(w.selectAll(".selection").style("display",null).attr("x",m[0][0]).attr("y",m[0][1]).attr("width",m[1][0]-m[0][0]).attr("height",m[1][1]-m[0][1]),w.selectAll(".handle").style("display",null).attr("x",function(p){return p.type[p.type.length-1]==="e"?m[1][0]-a/2:m[0][0]-a/2}).attr("y",function(p){return p.type[0]==="s"?m[1][1]-a/2:m[0][1]-a/2}).attr("width",function(p){return p.type==="n"||p.type==="s"?m[1][0]-m[0][0]+a:a}).attr("height",function(p){return p.type==="e"||p.type==="w"?m[1][1]-m[0][1]+a:a})):w.selectAll(".selection,.handle").style("display","none").attr("x",null).attr("y",null).attr("width",null).attr("height",null)}function h(w,m,p){var g=w.__brush.emitter;return g&&(!p||!g.clean)?g:new c(w,m,p)}function c(w,m,p){this.that=w,this.args=m,this.state=w.__brush,this.active=0,this.clean=p}c.prototype={beforestart:function(){return++this.active===1&&(this.state.emitter=this,this.starting=!0),this},start:function(w,m){return this.starting?(this.starting=!1,this.emit("start",w,m)):this.emit("brush",w),this},brush:function(w,m){return this.emit("brush",w,m),this},end:function(w,m){return--this.active===0&&(delete this.state.emitter,this.emit("end",w,m)),this},emit:function(w,m,p){var g=ut(this.that).datum();o.call(w,this.that,new vo(w,{sourceEvent:m,target:l,selection:t.output(this.state.selection),mode:p,dispatch:o}),g)}};function f(w){if(u&&!w.touches||!n.apply(this,arguments))return;var m=this,p=w.target.__data__.type,g=(i&&w.metaKey?p="overlay":p)==="selection"?Ur:i&&w.altKey?ye:pe,C=t===zn?null:yo[p],z=t===on?null:wo[p],T=Fn(m),H=T.extent,B=T.selection,M=H[0][0],b,v,N=H[0][1],L,d,x=H[1][0],y,D,A=H[1][1],R,I,j=0,P=0,Q,X=C&&z&&i&&w.shiftKey,at,ft,K=Array.from(w.touches||[w],G=>{const ct=G.identifier;return G=At(G,m),G.point0=G.slice(),G.identifier=ct,G});Ge(m);var ot=h(m,arguments,!0).beforestart();if(p==="overlay"){B&&(Q=!0);const G=[K[0],K[1]||K[0]];T.selection=B=[[b=t===zn?M:Ct(G[0][0],G[1][0]),L=t===on?N:Ct(G[0][1],G[1][1])],[y=t===zn?x:St(G[0][0],G[1][0]),R=t===on?A:St(G[0][1],G[1][1])]],K.length>1&&mt(w)}else b=B[0][0],L=B[0][1],y=B[1][0],R=B[1][1];v=b,d=L,D=y,I=R;var U=ut(m).attr("pointer-events","none"),tt=U.selectAll(".overlay").attr("cursor",Ht[p]);if(w.touches)ot.moved=F,ot.ended=ht;else{var nt=ut(w.view).on("mousemove.brush",F,!0).on("mouseup.brush",ht,!0);i&&nt.on("keydown.brush",yt,!0).on("keyup.brush",wt,!0),Ti(w.view)}s.call(m),ot.start(w,g.name);function F(G){for(const ct of G.changedTouches||[G])for(const $t of K)$t.identifier===ct.identifier&&($t.cur=At(ct,m));if(X&&!at&&!ft&&K.length===1){const ct=K[0];Ar(ct.cur[0]-ct[0])>Ar(ct.cur[1]-ct[1])?ft=!0:at=!0}for(const ct of K)ct.cur&&(ct[0]=ct.cur[0],ct[1]=ct.cur[1]);Q=!0,Dn(G),mt(G)}function mt(G){const ct=K[0],$t=ct.point0;var _t;switch(j=ct[0]-$t[0],P=ct[1]-$t[1],g){case En:case Ur:{C&&(j=St(M-b,Ct(x-y,j)),v=b+j,D=y+j),z&&(P=St(N-L,Ct(A-R,P)),d=L+P,I=R+P);break}case pe:{K[1]?(C&&(v=St(M,Ct(x,K[0][0])),D=St(M,Ct(x,K[1][0])),C=1),z&&(d=St(N,Ct(A,K[0][1])),I=St(N,Ct(A,K[1][1])),z=1)):(C<0?(j=St(M-b,Ct(x-b,j)),v=b+j,D=y):C>0&&(j=St(M-y,Ct(x-y,j)),v=b,D=y+j),z<0?(P=St(N-L,Ct(A-L,P)),d=L+P,I=R):z>0&&(P=St(N-R,Ct(A-R,P)),d=L,I=R+P));break}case ye:{C&&(v=St(M,Ct(x,b-j*C)),D=St(M,Ct(x,y+j*C))),z&&(d=St(N,Ct(A,L-P*z)),I=St(N,Ct(A,R+P*z)));break}}D<v&&(C*=-1,_t=b,b=y,y=_t,_t=v,v=D,D=_t,p in Ir&&tt.attr("cursor",Ht[p=Ir[p]])),I<d&&(z*=-1,_t=L,L=R,R=_t,_t=d,d=I,I=_t,p in Or&&tt.attr("cursor",Ht[p=Or[p]])),T.selection&&(B=T.selection),at&&(v=B[0][0],D=B[1][0]),ft&&(d=B[0][1],I=B[1][1]),(B[0][0]!==v||B[0][1]!==d||B[1][0]!==D||B[1][1]!==I)&&(T.selection=[[v,d],[D,I]],s.call(m),ot.brush(G,g.name))}function ht(G){if(po(G),G.touches){if(G.touches.length)return;u&&clearTimeout(u),u=setTimeout(function(){u=null},500)}else Si(G.view,Q),nt.on("keydown.brush keyup.brush mousemove.brush mouseup.brush",null);U.attr("pointer-events","all"),tt.attr("cursor",Ht.overlay),T.selection&&(B=T.selection),xo(B)&&(T.selection=null,s.call(m)),ot.end(G,g.name)}function yt(G){switch(G.keyCode){case 16:{X=C&&z;break}case 18:{g===pe&&(C&&(y=D-j*C,b=v+j*C),z&&(R=I-P*z,L=d+P*z),g=ye,mt(G));break}case 32:{(g===pe||g===ye)&&(C<0?y=D-j:C>0&&(b=v-j),z<0?R=I-P:z>0&&(L=d-P),g=En,tt.attr("cursor",Ht.selection),mt(G));break}default:return}Dn(G)}function wt(G){switch(G.keyCode){case 16:{X&&(at=ft=X=!1,mt(G));break}case 18:{g===ye&&(C<0?y=D:C>0&&(b=v),z<0?R=I:z>0&&(L=d),g=pe,mt(G));break}case 32:{g===En&&(G.altKey?(C&&(y=D-j*C,b=v+j*C),z&&(R=I-P*z,L=d+P*z),g=ye):(C<0?y=D:C>0&&(b=v),z<0?R=I:z>0&&(L=d),g=pe),tt.attr("cursor",Ht[p]),mt(G));break}default:return}Dn(G)}}function _(w){h(this,arguments).moved(w)}function E(w){h(this,arguments).ended(w)}function W(){var w=this.__brush||{selection:null};return w.extent=Lr(e.apply(this,arguments)),w.dim=t,w}return l.extent=function(w){return arguments.length?(e=typeof w=="function"?w:Cn(Lr(w)),l):e},l.filter=function(w){return arguments.length?(n=typeof w=="function"?w:Cn(!!w),l):n},l.touchable=function(w){return arguments.length?(r=typeof w=="function"?w:Cn(!!w),l):r},l.handleSize=function(w){return arguments.length?(a=+w,l):a},l.keyModifiers=function(w){return arguments.length?(i=!!w,l):i},l.on=function(){var w=o.on.apply(o,arguments);return w===o?l:w},l}const Jn=Math.PI,tr=2*Jn,le=1e-6,To=tr-le;function Ci(t){this._+=t[0];for(let e=1,n=t.length;e<n;++e)this._+=arguments[e]+t[e]}function So(t){let e=Math.floor(t);if(!(e>=0))throw new Error(`invalid digits: ${t}`);if(e>15)return Ci;const n=10**e;return function(r){this._+=r[0];for(let i=1,o=r.length;i<o;++i)this._+=Math.round(arguments[i]*n)/n+r[i]}}class Co{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=e==null?Ci:So(e)}moveTo(e,n){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,n){this._append`L${this._x1=+e},${this._y1=+n}`}quadraticCurveTo(e,n,r,i){this._append`Q${+e},${+n},${this._x1=+r},${this._y1=+i}`}bezierCurveTo(e,n,r,i,o,a){this._append`C${+e},${+n},${+r},${+i},${this._x1=+o},${this._y1=+a}`}arcTo(e,n,r,i,o){if(e=+e,n=+n,r=+r,i=+i,o=+o,o<0)throw new Error(`negative radius: ${o}`);let a=this._x1,u=this._y1,l=r-e,s=i-n,h=a-e,c=u-n,f=h*h+c*c;if(this._x1===null)this._append`M${this._x1=e},${this._y1=n}`;else if(f>le)if(!(Math.abs(c*l-s*h)>le)||!o)this._append`L${this._x1=e},${this._y1=n}`;else{let _=r-a,E=i-u,W=l*l+s*s,w=_*_+E*E,m=Math.sqrt(W),p=Math.sqrt(f),g=o*Math.tan((Jn-Math.acos((W+f-w)/(2*m*p)))/2),C=g/p,z=g/m;Math.abs(C-1)>le&&this._append`L${e+C*h},${n+C*c}`,this._append`A${o},${o},0,0,${+(c*_>h*E)},${this._x1=e+z*l},${this._y1=n+z*s}`}}arc(e,n,r,i,o,a){if(e=+e,n=+n,r=+r,a=!!a,r<0)throw new Error(`negative radius: ${r}`);let u=r*Math.cos(i),l=r*Math.sin(i),s=e+u,h=n+l,c=1^a,f=a?i-o:o-i;this._x1===null?this._append`M${s},${h}`:(Math.abs(this._x1-s)>le||Math.abs(this._y1-h)>le)&&this._append`L${s},${h}`,r&&(f<0&&(f=f%tr+tr),f>To?this._append`A${r},${r},0,1,${c},${e-u},${n-l}A${r},${r},0,1,${c},${this._x1=s},${this._y1=h}`:f>le&&this._append`A${r},${r},0,${+(f>=Jn)},${c},${this._x1=e+r*Math.cos(o)},${this._y1=n+r*Math.sin(o)}`)}rect(e,n,r,i){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+n}h${r=+r}v${+i}h${-r}Z`}toString(){return this._}}var Do=Array.prototype,Di=Do.slice;function Eo(t,e){return t-e}function zo(t){for(var e=0,n=t.length,r=t[n-1][1]*t[0][0]-t[n-1][0]*t[0][1];++e<n;)r+=t[e-1][1]*t[e][0]-t[e-1][0]*t[e][1];return r}const ne=t=>()=>t;function Fo(t,e){for(var n=-1,r=e.length,i;++n<r;)if(i=Ro(t,e[n]))return i;return 0}function Ro(t,e){for(var n=e[0],r=e[1],i=-1,o=0,a=t.length,u=a-1;o<a;u=o++){var l=t[o],s=l[0],h=l[1],c=t[u],f=c[0],_=c[1];if(Uo(l,c,e))return 0;h>r!=_>r&&n<(f-s)*(r-h)/(_-h)+s&&(i=-i)}return i}function Uo(t,e,n){var r;return Ao(t,e,n)&&No(t[r=+(t[0]===e[0])],n[r],e[r])}function Ao(t,e,n){return(e[0]-t[0])*(n[1]-t[1])===(n[0]-t[0])*(e[1]-t[1])}function No(t,e,n){return t<=e&&e<=n||n<=e&&e<=t}function Lo(){}var Vt=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]];function Yr(){var t=1,e=1,n=Xa,r=l;function i(s){var h=n(s);if(Array.isArray(h))h=h.slice().sort(Eo);else{const c=qe(s,Io);for(h=mr(...qa(c[0],c[1],h),h);h[h.length-1]>=c[1];)h.pop();for(;h[1]<c[0];)h.shift()}return h.map(c=>o(s,c))}function o(s,h){const c=h==null?NaN:+h;if(isNaN(c))throw new Error(`invalid value: ${h}`);var f=[],_=[];return a(s,c,function(E){r(E,s,c),zo(E)>0?f.push([E]):_.push(E)}),_.forEach(function(E){for(var W=0,w=f.length,m;W<w;++W)if(Fo((m=f[W])[0],E)!==-1){m.push(E);return}}),{type:"MultiPolygon",value:h,coordinates:f}}function a(s,h,c){var f=new Array,_=new Array,E,W,w,m,p,g;for(E=W=-1,m=se(s[0],h),Vt[m<<1].forEach(C);++E<t-1;)w=m,m=se(s[E+1],h),Vt[w|m<<1].forEach(C);for(Vt[m<<0].forEach(C);++W<e-1;){for(E=-1,m=se(s[W*t+t],h),p=se(s[W*t],h),Vt[m<<1|p<<2].forEach(C);++E<t-1;)w=m,m=se(s[W*t+t+E+1],h),g=p,p=se(s[W*t+E+1],h),Vt[w|m<<1|p<<2|g<<3].forEach(C);Vt[m|p<<3].forEach(C)}for(E=-1,p=s[W*t]>=h,Vt[p<<2].forEach(C);++E<t-1;)g=p,p=se(s[W*t+E+1],h),Vt[p<<2|g<<3].forEach(C);Vt[p<<3].forEach(C);function C(z){var T=[z[0][0]+E,z[0][1]+W],H=[z[1][0]+E,z[1][1]+W],B=u(T),M=u(H),b,v;(b=_[B])?(v=f[M])?(delete _[b.end],delete f[v.start],b===v?(b.ring.push(H),c(b.ring)):f[b.start]=_[v.end]={start:b.start,end:v.end,ring:b.ring.concat(v.ring)}):(delete _[b.end],b.ring.push(H),_[b.end=M]=b):(b=f[M])?(v=_[B])?(delete f[b.start],delete _[v.end],b===v?(b.ring.push(H),c(b.ring)):f[v.start]=_[b.end]={start:v.start,end:b.end,ring:v.ring.concat(b.ring)}):(delete f[b.start],b.ring.unshift(T),f[b.start=B]=b):f[B]=_[M]={start:B,end:M,ring:[T,H]}}}function u(s){return s[0]*2+s[1]*(t+1)*4}function l(s,h,c){s.forEach(function(f){var _=f[0],E=f[1],W=_|0,w=E|0,m=Rn(h[w*t+W]);_>0&&_<t&&W===_&&(f[0]=Pr(_,Rn(h[w*t+W-1]),m,c)),E>0&&E<e&&w===E&&(f[1]=Pr(E,Rn(h[(w-1)*t+W]),m,c))})}return i.contour=o,i.size=function(s){if(!arguments.length)return[t,e];var h=Math.floor(s[0]),c=Math.floor(s[1]);if(!(h>=0&&c>=0))throw new Error("invalid size");return t=h,e=c,i},i.thresholds=function(s){return arguments.length?(n=typeof s=="function"?s:Array.isArray(s)?ne(Di.call(s)):ne(s),i):n},i.smooth=function(s){return arguments.length?(r=s?l:Lo,i):r===l},i}function Io(t){return isFinite(t)?t:NaN}function se(t,e){return t==null?!1:+t>=e}function Rn(t){return t==null||isNaN(t=+t)?-1/0:t}function Pr(t,e,n,r){const i=r-e,o=n-e,a=isFinite(i)||isFinite(o)?i/o:Math.sign(i)/Math.sign(o);return isNaN(a)?t:t+a-.5}function Oo(t){return t[0]}function Yo(t){return t[1]}function Po(){return 1}function Wo(){var t=Oo,e=Yo,n=Po,r=960,i=500,o=20,a=2,u=o*3,l=r+u*2>>a,s=i+u*2>>a,h=ne(20);function c(p){var g=new Float32Array(l*s),C=Math.pow(2,-a),z=-1;for(const L of p){var T=(t(L,++z,p)+u)*C,H=(e(L,z,p)+u)*C,B=+n(L,z,p);if(B&&T>=0&&T<l&&H>=0&&H<s){var M=Math.floor(T),b=Math.floor(H),v=T-M-.5,N=H-b-.5;g[M+b*l]+=(1-v)*(1-N)*B,g[M+1+b*l]+=v*(1-N)*B,g[M+1+(b+1)*l]+=v*N*B,g[M+(b+1)*l]+=(1-v)*N*B}}return Ra({data:g,width:l,height:s},o*C),g}function f(p){var g=c(p),C=h(g),z=Math.pow(2,2*a);return Array.isArray(C)||(C=mr(Number.MIN_VALUE,Ke(g)/z,C)),Yr().size([l,s]).thresholds(C.map(T=>T*z))(g).map((T,H)=>(T.value=+C[H],_(T)))}f.contours=function(p){var g=c(p),C=Yr().size([l,s]),z=Math.pow(2,2*a),T=H=>{H=+H;var B=_(C.contour(g,H*z));return B.value=H,B};return Object.defineProperty(T,"max",{get:()=>Ke(g)/z}),T};function _(p){return p.coordinates.forEach(E),p}function E(p){p.forEach(W)}function W(p){p.forEach(w)}function w(p){p[0]=p[0]*Math.pow(2,a)-u,p[1]=p[1]*Math.pow(2,a)-u}function m(){return u=o*3,l=r+u*2>>a,s=i+u*2>>a,f}return f.x=function(p){return arguments.length?(t=typeof p=="function"?p:ne(+p),f):t},f.y=function(p){return arguments.length?(e=typeof p=="function"?p:ne(+p),f):e},f.weight=function(p){return arguments.length?(n=typeof p=="function"?p:ne(+p),f):n},f.size=function(p){if(!arguments.length)return[r,i];var g=+p[0],C=+p[1];if(!(g>=0&&C>=0))throw new Error("invalid size");return r=g,i=C,m()},f.cellSize=function(p){if(!arguments.length)return 1<<a;if(!((p=+p)>=1))throw new Error("invalid cell size");return a=Math.floor(Math.log(p)/Math.LN2),m()},f.thresholds=function(p){return arguments.length?(h=typeof p=="function"?p:Array.isArray(p)?ne(Di.call(p)):ne(p),f):h},f.bandwidth=function(p){if(!arguments.length)return Math.sqrt(o*(o+1));if(!((p=+p)>=0))throw new Error("invalid bandwidth");return o=(Math.sqrt(4*p*p+1)-1)/2,m()},f}function Ho(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function cn(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}function ke(t){return t=cn(Math.abs(t)),t?t[1]:NaN}function Vo(t,e){return function(n,r){for(var i=n.length,o=[],a=0,u=t[0],l=0;i>0&&u>0&&(l+u+1>r&&(u=Math.max(1,r-l)),o.push(n.substring(i-=u,i+u)),!((l+=u+1)>r));)u=t[a=(a+1)%t.length];return o.reverse().join(e)}}function Bo(t){return function(e){return e.replace(/[0-9]/g,function(n){return t[+n]})}}var jo=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function fn(t){if(!(e=jo.exec(t)))throw new Error("invalid format: "+t);var e;return new gr({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}fn.prototype=gr.prototype;function gr(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}gr.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Go(t){t:for(var e=t.length,n=1,r=-1,i;n<e;++n)switch(t[n]){case".":r=i=n;break;case"0":r===0&&(r=n),i=n;break;default:if(!+t[n])break t;r>0&&(r=0);break}return r>0?t.slice(0,r)+t.slice(i+1):t}var Ei;function qo(t,e){var n=cn(t,e);if(!n)return t+"";var r=n[0],i=n[1],o=i-(Ei=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,a=r.length;return o===a?r:o>a?r+new Array(o-a+1).join("0"):o>0?r.slice(0,o)+"."+r.slice(o):"0."+new Array(1-o).join("0")+cn(t,Math.max(0,e+o-1))[0]}function Wr(t,e){var n=cn(t,e);if(!n)return t+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}const Hr={"%":(t,e)=>(t*100).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:Ho,e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>Wr(t*100,e),r:Wr,s:qo,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function Vr(t){return t}var Br=Array.prototype.map,jr=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function Xo(t){var e=t.grouping===void 0||t.thousands===void 0?Vr:Vo(Br.call(t.grouping,Number),t.thousands+""),n=t.currency===void 0?"":t.currency[0]+"",r=t.currency===void 0?"":t.currency[1]+"",i=t.decimal===void 0?".":t.decimal+"",o=t.numerals===void 0?Vr:Bo(Br.call(t.numerals,String)),a=t.percent===void 0?"%":t.percent+"",u=t.minus===void 0?"−":t.minus+"",l=t.nan===void 0?"NaN":t.nan+"";function s(c){c=fn(c);var f=c.fill,_=c.align,E=c.sign,W=c.symbol,w=c.zero,m=c.width,p=c.comma,g=c.precision,C=c.trim,z=c.type;z==="n"?(p=!0,z="g"):Hr[z]||(g===void 0&&(g=12),C=!0,z="g"),(w||f==="0"&&_==="=")&&(w=!0,f="0",_="=");var T=W==="$"?n:W==="#"&&/[boxX]/.test(z)?"0"+z.toLowerCase():"",H=W==="$"?r:/[%p]/.test(z)?a:"",B=Hr[z],M=/[defgprs%]/.test(z);g=g===void 0?6:/[gprs]/.test(z)?Math.max(1,Math.min(21,g)):Math.max(0,Math.min(20,g));function b(v){var N=T,L=H,d,x,y;if(z==="c")L=B(v)+L,v="";else{v=+v;var D=v<0||1/v<0;if(v=isNaN(v)?l:B(Math.abs(v),g),C&&(v=Go(v)),D&&+v==0&&E!=="+"&&(D=!1),N=(D?E==="("?E:u:E==="-"||E==="("?"":E)+N,L=(z==="s"?jr[8+Ei/3]:"")+L+(D&&E==="("?")":""),M){for(d=-1,x=v.length;++d<x;)if(y=v.charCodeAt(d),48>y||y>57){L=(y===46?i+v.slice(d+1):v.slice(d))+L,v=v.slice(0,d);break}}}p&&!w&&(v=e(v,1/0));var A=N.length+v.length+L.length,R=A<m?new Array(m-A+1).join(f):"";switch(p&&w&&(v=e(R+v,R.length?m-L.length:1/0),R=""),_){case"<":v=N+v+L+R;break;case"=":v=N+R+v+L;break;case"^":v=R.slice(0,A=R.length>>1)+N+v+L+R.slice(A);break;default:v=R+N+v+L;break}return o(v)}return b.toString=function(){return c+""},b}function h(c,f){var _=s((c=fn(c),c.type="f",c)),E=Math.max(-8,Math.min(8,Math.floor(ke(f)/3)))*3,W=Math.pow(10,-E),w=jr[8+E/3];return function(m){return _(W*m)+w}}return{format:s,formatPrefix:h}}var nn,zi,Fi;Zo({thousands:",",grouping:[3],currency:["$",""]});function Zo(t){return nn=Xo(t),zi=nn.format,Fi=nn.formatPrefix,nn}function Ko(t){return Math.max(0,-ke(Math.abs(t)))}function Qo(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(ke(e)/3)))*3-ke(Math.abs(t)))}function Jo(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,ke(e)-ke(t))+1}var ts=Math.PI,es=ts*2,ns=Math.abs,vr=Math.sqrt;function It(){}function hn(t,e){t&&qr.hasOwnProperty(t.type)&&qr[t.type](t,e)}var Gr={Feature:function(t,e){hn(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,r=-1,i=n.length;++r<i;)hn(n[r].geometry,e)}},qr={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)t=n[r],e.point(t[0],t[1],t[2])},LineString:function(t,e){er(t.coordinates,e,0)},MultiLineString:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)er(n[r],e,0)},Polygon:function(t,e){Xr(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)Xr(n[r],e)},GeometryCollection:function(t,e){for(var n=t.geometries,r=-1,i=n.length;++r<i;)hn(n[r],e)}};function er(t,e,n){var r=-1,i=t.length-n,o;for(e.lineStart();++r<i;)o=t[r],e.point(o[0],o[1],o[2]);e.lineEnd()}function Xr(t,e){var n=-1,r=t.length;for(e.polygonStart();++n<r;)er(t[n],e,1);e.polygonEnd()}function Ie(t,e){t&&Gr.hasOwnProperty(t.type)?Gr[t.type](t,e):hn(t,e)}const rs=t=>t;var Un=new xe,nr=new xe,Ri,Ui,rr,ir,qt={point:It,lineStart:It,lineEnd:It,polygonStart:function(){qt.lineStart=is,qt.lineEnd=os},polygonEnd:function(){qt.lineStart=qt.lineEnd=qt.point=It,Un.add(ns(nr)),nr=new xe},result:function(){var t=Un/2;return Un=new xe,t}};function is(){qt.point=as}function as(t,e){qt.point=Ai,Ri=rr=t,Ui=ir=e}function Ai(t,e){nr.add(ir*t-rr*e),rr=t,ir=e}function os(){Ai(Ri,Ui)}var $e=1/0,dn=$e,Je=-$e,mn=Je,Zr={point:ss,lineStart:It,lineEnd:It,polygonStart:It,polygonEnd:It,result:function(){var t=[[$e,dn],[Je,mn]];return Je=mn=-(dn=$e=1/0),t}};function ss(t,e){t<$e&&($e=t),t>Je&&(Je=t),e<dn&&(dn=e),e>mn&&(mn=e)}var ar=0,or=0,He=0,gn=0,vn=0,be=0,sr=0,ur=0,Ve=0,Ni,Li,Yt,Pt,Ft={point:fe,lineStart:Kr,lineEnd:Qr,polygonStart:function(){Ft.lineStart=cs,Ft.lineEnd=fs},polygonEnd:function(){Ft.point=fe,Ft.lineStart=Kr,Ft.lineEnd=Qr},result:function(){var t=Ve?[sr/Ve,ur/Ve]:be?[gn/be,vn/be]:He?[ar/He,or/He]:[NaN,NaN];return ar=or=He=gn=vn=be=sr=ur=Ve=0,t}};function fe(t,e){ar+=t,or+=e,++He}function Kr(){Ft.point=us}function us(t,e){Ft.point=ls,fe(Yt=t,Pt=e)}function ls(t,e){var n=t-Yt,r=e-Pt,i=vr(n*n+r*r);gn+=i*(Yt+t)/2,vn+=i*(Pt+e)/2,be+=i,fe(Yt=t,Pt=e)}function Qr(){Ft.point=fe}function cs(){Ft.point=hs}function fs(){Ii(Ni,Li)}function hs(t,e){Ft.point=Ii,fe(Ni=Yt=t,Li=Pt=e)}function Ii(t,e){var n=t-Yt,r=e-Pt,i=vr(n*n+r*r);gn+=i*(Yt+t)/2,vn+=i*(Pt+e)/2,be+=i,i=Pt*t-Yt*e,sr+=i*(Yt+t),ur+=i*(Pt+e),Ve+=i*3,fe(Yt=t,Pt=e)}function Oi(t){this._context=t}Oi.prototype={_radius:4.5,pointRadius:function(t){return this._radius=t,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(t,e){switch(this._point){case 0:{this._context.moveTo(t,e),this._point=1;break}case 1:{this._context.lineTo(t,e);break}default:{this._context.moveTo(t+this._radius,e),this._context.arc(t,e,this._radius,0,es);break}}},result:It};var lr=new xe,An,Yi,Pi,Be,je,tn={point:It,lineStart:function(){tn.point=ds},lineEnd:function(){An&&Wi(Yi,Pi),tn.point=It},polygonStart:function(){An=!0},polygonEnd:function(){An=null},result:function(){var t=+lr;return lr=new xe,t}};function ds(t,e){tn.point=Wi,Yi=Be=t,Pi=je=e}function Wi(t,e){Be-=t,je-=e,lr.add(vr(Be*Be+je*je)),Be=t,je=e}let Jr,pn,ti,ei;class ni{constructor(e){this._append=e==null?Hi:ms(e),this._radius=4.5,this._=""}pointRadius(e){return this._radius=+e,this}polygonStart(){this._line=0}polygonEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){this._line===0&&(this._+="Z"),this._point=NaN}point(e,n){switch(this._point){case 0:{this._append`M${e},${n}`,this._point=1;break}case 1:{this._append`L${e},${n}`;break}default:{if(this._append`M${e},${n}`,this._radius!==ti||this._append!==pn){const r=this._radius,i=this._;this._="",this._append`m0,${r}a${r},${r} 0 1,1 0,${-2*r}a${r},${r} 0 1,1 0,${2*r}z`,ti=r,pn=this._append,ei=this._,this._=i}this._+=ei;break}}}result(){const e=this._;return this._="",e.length?e:null}}function Hi(t){let e=1;this._+=t[0];for(const n=t.length;e<n;++e)this._+=arguments[e]+t[e]}function ms(t){const e=Math.floor(t);if(!(e>=0))throw new RangeError(`invalid digits: ${t}`);if(e>15)return Hi;if(e!==Jr){const n=10**e;Jr=e,pn=function(i){let o=1;this._+=i[0];for(const a=i.length;o<a;++o)this._+=Math.round(arguments[o]*n)/n+i[o]}}return pn}function ri(t,e){let n=3,r=4.5,i,o;function a(u){return u&&(typeof r=="function"&&o.pointRadius(+r.apply(this,arguments)),Ie(u,i(o))),o.result()}return a.area=function(u){return Ie(u,i(qt)),qt.result()},a.measure=function(u){return Ie(u,i(tn)),tn.result()},a.bounds=function(u){return Ie(u,i(Zr)),Zr.result()},a.centroid=function(u){return Ie(u,i(Ft)),Ft.result()},a.projection=function(u){return arguments.length?(i=u==null?(t=null,rs):(t=u).stream,a):t},a.context=function(u){return arguments.length?(o=u==null?(e=null,new ni(n)):new Oi(e=u),typeof r!="function"&&o.pointRadius(r),a):e},a.pointRadius=function(u){return arguments.length?(r=typeof u=="function"?u:(o.pointRadius(+u),+u),a):r},a.digits=function(u){if(!arguments.length)return n;if(u==null)n=null;else{const l=Math.floor(u);if(!(l>=0))throw new RangeError(`invalid digits: ${u}`);n=l}return e===null&&(o=new ni(n)),a},a.projection(t).digits(n).context(e)}function Vi(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}function gs(t){return function(){return t}}function vs(t){return+t}var ii=[0,1];function _e(t){return t}function cr(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:gs(isNaN(e)?NaN:.5)}function ps(t,e){var n;return t>e&&(n=t,t=e,e=n),function(r){return Math.max(t,Math.min(e,r))}}function ys(t,e,n){var r=t[0],i=t[1],o=e[0],a=e[1];return i<r?(r=cr(i,r),o=n(a,o)):(r=cr(r,i),o=n(o,a)),function(u){return o(r(u))}}function ws(t,e,n){var r=Math.min(t.length,e.length)-1,i=new Array(r),o=new Array(r),a=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++a<r;)i[a]=cr(t[a],t[a+1]),o[a]=n(e[a],e[a+1]);return function(u){var l=Fa(t,u,1,r)-1;return o[l](i[l](u))}}function Bi(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function bs(){var t=ii,e=ii,n=Mn,r,i,o,a=_e,u,l,s;function h(){var f=Math.min(t.length,e.length);return a!==_e&&(a=ps(t[0],t[f-1])),u=f>2?ws:ys,l=s=null,c}function c(f){return f==null||isNaN(f=+f)?o:(l||(l=u(t.map(r),e,n)))(r(a(f)))}return c.invert=function(f){return a(i((s||(s=u(e,t.map(r),Vn)))(f)))},c.domain=function(f){return arguments.length?(t=Array.from(f,vs),h()):t.slice()},c.range=function(f){return arguments.length?(e=Array.from(f),h()):e.slice()},c.rangeRound=function(f){return e=Array.from(f),n=co,h()},c.clamp=function(f){return arguments.length?(a=f?!0:_e,h()):a!==_e},c.interpolate=function(f){return arguments.length?(n=f,h()):n},c.unknown=function(f){return arguments.length?(o=f,c):o},function(f,_){return r=f,i=_,h()}}function ji(){return bs()(_e,_e)}function _s(t,e,n,r){var i=Xn(t,e,n),o;switch(r=fn(r??",f"),r.type){case"s":{var a=Math.max(Math.abs(t),Math.abs(e));return r.precision==null&&!isNaN(o=Qo(i,a))&&(r.precision=o),Fi(r,a)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(o=Jo(i,Math.max(Math.abs(t),Math.abs(e))))&&(r.precision=o-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(o=Ko(i))&&(r.precision=o-(r.type==="%")*2);break}}return zi(r)}function Ms(t){var e=t.domain;return t.ticks=function(n){var r=e();return mr(r[0],r[r.length-1],n??10)},t.tickFormat=function(n,r){var i=e();return _s(i[0],i[i.length-1],n??10,r)},t.nice=function(n){n==null&&(n=10);var r=e(),i=0,o=r.length-1,a=r[i],u=r[o],l,s,h=10;for(u<a&&(s=a,a=u,u=s,s=i,i=o,o=s);h-- >0;){if(s=ln(a,u,n),s===l)return r[i]=a,r[o]=u,e(r);if(s>0)a=Math.floor(a/s)*s,u=Math.ceil(u/s)*s;else if(s<0)a=Math.ceil(a*s)/s,u=Math.floor(u*s)/s;else break;l=s}return t},t}function Wt(){var t=ji();return t.copy=function(){return Bi(t,Wt())},Vi.apply(t,arguments),Ms(t)}function xs(t,e){t=t.slice();var n=0,r=t.length-1,i=t[n],o=t[r],a;return o<i&&(a=n,n=r,r=a,a=i,i=o,o=a),t[n]=e.floor(i),t[r]=e.ceil(o),t}const Nn=new Date,Ln=new Date;function Mt(t,e,n,r){function i(o){return t(o=arguments.length===0?new Date:new Date(+o)),o}return i.floor=o=>(t(o=new Date(+o)),o),i.ceil=o=>(t(o=new Date(o-1)),e(o,1),t(o),o),i.round=o=>{const a=i(o),u=i.ceil(o);return o-a<u-o?a:u},i.offset=(o,a)=>(e(o=new Date(+o),a==null?1:Math.floor(a)),o),i.range=(o,a,u)=>{const l=[];if(o=i.ceil(o),u=u==null?1:Math.floor(u),!(o<a)||!(u>0))return l;let s;do l.push(s=new Date(+o)),e(o,u),t(o);while(s<o&&o<a);return l},i.filter=o=>Mt(a=>{if(a>=a)for(;t(a),!o(a);)a.setTime(a-1)},(a,u)=>{if(a>=a)if(u<0)for(;++u<=0;)for(;e(a,-1),!o(a););else for(;--u>=0;)for(;e(a,1),!o(a););}),n&&(i.count=(o,a)=>(Nn.setTime(+o),Ln.setTime(+a),t(Nn),t(Ln),Math.floor(n(Nn,Ln))),i.every=o=>(o=Math.floor(o),!isFinite(o)||!(o>0)?null:o>1?i.filter(r?a=>r(a)%o===0:a=>i.count(0,a)%o===0):i)),i}const yn=Mt(()=>{},(t,e)=>{t.setTime(+t+e)},(t,e)=>e-t);yn.every=t=>(t=Math.floor(t),!isFinite(t)||!(t>0)?null:t>1?Mt(e=>{e.setTime(Math.floor(e/t)*t)},(e,n)=>{e.setTime(+e+n*t)},(e,n)=>(n-e)/t):yn);yn.range;const Kt=1e3,Rt=Kt*60,Qt=Rt*60,Jt=Qt*24,pr=Jt*7,ai=Jt*30,In=Jt*365,Me=Mt(t=>{t.setTime(t-t.getMilliseconds())},(t,e)=>{t.setTime(+t+e*Kt)},(t,e)=>(e-t)/Kt,t=>t.getUTCSeconds());Me.range;const yr=Mt(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*Kt)},(t,e)=>{t.setTime(+t+e*Rt)},(t,e)=>(e-t)/Rt,t=>t.getMinutes());yr.range;const ks=Mt(t=>{t.setUTCSeconds(0,0)},(t,e)=>{t.setTime(+t+e*Rt)},(t,e)=>(e-t)/Rt,t=>t.getUTCMinutes());ks.range;const wr=Mt(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*Kt-t.getMinutes()*Rt)},(t,e)=>{t.setTime(+t+e*Qt)},(t,e)=>(e-t)/Qt,t=>t.getHours());wr.range;const $s=Mt(t=>{t.setUTCMinutes(0,0,0)},(t,e)=>{t.setTime(+t+e*Qt)},(t,e)=>(e-t)/Qt,t=>t.getUTCHours());$s.range;const Nt=Mt(t=>t.setHours(0,0,0,0),(t,e)=>t.setDate(t.getDate()+e),(t,e)=>(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*Rt)/Jt,t=>t.getDate()-1);Nt.range;const br=Mt(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/Jt,t=>t.getUTCDate()-1);br.range;const Ts=Mt(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/Jt,t=>Math.floor(t/Jt));Ts.range;function de(t){return Mt(e=>{e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)},(e,n)=>{e.setDate(e.getDate()+n*7)},(e,n)=>(n-e-(n.getTimezoneOffset()-e.getTimezoneOffset())*Rt)/pr)}const xn=de(0),Te=de(1),Ss=de(2),Cs=de(3),Se=de(4),Ds=de(5),Es=de(6);xn.range;Te.range;Ss.range;Cs.range;Se.range;Ds.range;Es.range;function me(t){return Mt(e=>{e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)},(e,n)=>{e.setUTCDate(e.getUTCDate()+n*7)},(e,n)=>(n-e)/pr)}const Gi=me(0),wn=me(1),zs=me(2),Fs=me(3),Ce=me(4),Rs=me(5),Us=me(6);Gi.range;wn.range;zs.range;Fs.range;Ce.range;Rs.range;Us.range;const Xt=Mt(t=>{t.setDate(1),t.setHours(0,0,0,0)},(t,e)=>{t.setMonth(t.getMonth()+e)},(t,e)=>e.getMonth()-t.getMonth()+(e.getFullYear()-t.getFullYear())*12,t=>t.getMonth());Xt.range;const As=Mt(t=>{t.setUTCDate(1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCMonth(t.getUTCMonth()+e)},(t,e)=>e.getUTCMonth()-t.getUTCMonth()+(e.getUTCFullYear()-t.getUTCFullYear())*12,t=>t.getUTCMonth());As.range;const Ot=Mt(t=>{t.setMonth(0,1),t.setHours(0,0,0,0)},(t,e)=>{t.setFullYear(t.getFullYear()+e)},(t,e)=>e.getFullYear()-t.getFullYear(),t=>t.getFullYear());Ot.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:Mt(e=>{e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)},(e,n)=>{e.setFullYear(e.getFullYear()+n*t)});Ot.range;const he=Mt(t=>{t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCFullYear(t.getUTCFullYear()+e)},(t,e)=>e.getUTCFullYear()-t.getUTCFullYear(),t=>t.getUTCFullYear());he.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:Mt(e=>{e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,n)=>{e.setUTCFullYear(e.getUTCFullYear()+n*t)});he.range;function Ns(t,e,n,r,i,o){const a=[[Me,1,Kt],[Me,5,5*Kt],[Me,15,15*Kt],[Me,30,30*Kt],[o,1,Rt],[o,5,5*Rt],[o,15,15*Rt],[o,30,30*Rt],[i,1,Qt],[i,3,3*Qt],[i,6,6*Qt],[i,12,12*Qt],[r,1,Jt],[r,2,2*Jt],[n,1,pr],[e,1,ai],[e,3,3*ai],[t,1,In]];function u(s,h,c){const f=h<s;f&&([s,h]=[h,s]);const _=c&&typeof c.range=="function"?c:l(s,h,c),E=_?_.range(s,+h+1):[];return f?E.reverse():E}function l(s,h,c){const f=Math.abs(h-s)/c,_=dr(([,,w])=>w).right(a,f);if(_===a.length)return t.every(Xn(s/In,h/In,c));if(_===0)return yn.every(Math.max(Xn(s,h,c),1));const[E,W]=a[f/a[_-1][2]<a[_][2]/f?_-1:_];return E.every(W)}return[u,l]}const[Ls,Is]=Ns(Ot,Xt,xn,Nt,wr,yr);function On(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function Yn(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function Oe(t,e,n){return{y:t,m:e,d:n,H:0,M:0,S:0,L:0}}function Os(t){var e=t.dateTime,n=t.date,r=t.time,i=t.periods,o=t.days,a=t.shortDays,u=t.months,l=t.shortMonths,s=Ye(i),h=Pe(i),c=Ye(o),f=Pe(o),_=Ye(a),E=Pe(a),W=Ye(u),w=Pe(u),m=Ye(l),p=Pe(l),g={a:D,A,b:R,B:I,c:null,d:fi,e:fi,f:uu,g:yu,G:bu,H:au,I:ou,j:su,L:qi,m:lu,M:cu,p:j,q:P,Q:mi,s:gi,S:fu,u:hu,U:du,V:mu,w:gu,W:vu,x:null,X:null,y:pu,Y:wu,Z:_u,"%":di},C={a:Q,A:X,b:at,B:ft,c:null,d:hi,e:hi,f:$u,g:Au,G:Lu,H:Mu,I:xu,j:ku,L:Zi,m:Tu,M:Su,p:K,q:ot,Q:mi,s:gi,S:Cu,u:Du,U:Eu,V:zu,w:Fu,W:Ru,x:null,X:null,y:Uu,Y:Nu,Z:Iu,"%":di},z={a:b,A:v,b:N,B:L,c:d,d:li,e:li,f:eu,g:ui,G:si,H:ci,I:ci,j:Ks,L:tu,m:Zs,M:Qs,p:M,q:Xs,Q:ru,s:iu,S:Js,u:Vs,U:Bs,V:js,w:Hs,W:Gs,x,X:y,y:ui,Y:si,Z:qs,"%":nu};g.x=T(n,g),g.X=T(r,g),g.c=T(e,g),C.x=T(n,C),C.X=T(r,C),C.c=T(e,C);function T(U,tt){return function(nt){var F=[],mt=-1,ht=0,yt=U.length,wt,G,ct;for(nt instanceof Date||(nt=new Date(+nt));++mt<yt;)U.charCodeAt(mt)===37&&(F.push(U.slice(ht,mt)),(G=oi[wt=U.charAt(++mt)])!=null?wt=U.charAt(++mt):G=wt==="e"?" ":"0",(ct=tt[wt])&&(wt=ct(nt,G)),F.push(wt),ht=mt+1);return F.push(U.slice(ht,mt)),F.join("")}}function H(U,tt){return function(nt){var F=Oe(1900,void 0,1),mt=B(F,U,nt+="",0),ht,yt;if(mt!=nt.length)return null;if("Q"in F)return new Date(F.Q);if("s"in F)return new Date(F.s*1e3+("L"in F?F.L:0));if(tt&&!("Z"in F)&&(F.Z=0),"p"in F&&(F.H=F.H%12+F.p*12),F.m===void 0&&(F.m="q"in F?F.q:0),"V"in F){if(F.V<1||F.V>53)return null;"w"in F||(F.w=1),"Z"in F?(ht=Yn(Oe(F.y,0,1)),yt=ht.getUTCDay(),ht=yt>4||yt===0?wn.ceil(ht):wn(ht),ht=br.offset(ht,(F.V-1)*7),F.y=ht.getUTCFullYear(),F.m=ht.getUTCMonth(),F.d=ht.getUTCDate()+(F.w+6)%7):(ht=On(Oe(F.y,0,1)),yt=ht.getDay(),ht=yt>4||yt===0?Te.ceil(ht):Te(ht),ht=Nt.offset(ht,(F.V-1)*7),F.y=ht.getFullYear(),F.m=ht.getMonth(),F.d=ht.getDate()+(F.w+6)%7)}else("W"in F||"U"in F)&&("w"in F||(F.w="u"in F?F.u%7:"W"in F?1:0),yt="Z"in F?Yn(Oe(F.y,0,1)).getUTCDay():On(Oe(F.y,0,1)).getDay(),F.m=0,F.d="W"in F?(F.w+6)%7+F.W*7-(yt+5)%7:F.w+F.U*7-(yt+6)%7);return"Z"in F?(F.H+=F.Z/100|0,F.M+=F.Z%100,Yn(F)):On(F)}}function B(U,tt,nt,F){for(var mt=0,ht=tt.length,yt=nt.length,wt,G;mt<ht;){if(F>=yt)return-1;if(wt=tt.charCodeAt(mt++),wt===37){if(wt=tt.charAt(mt++),G=z[wt in oi?tt.charAt(mt++):wt],!G||(F=G(U,nt,F))<0)return-1}else if(wt!=nt.charCodeAt(F++))return-1}return F}function M(U,tt,nt){var F=s.exec(tt.slice(nt));return F?(U.p=h.get(F[0].toLowerCase()),nt+F[0].length):-1}function b(U,tt,nt){var F=_.exec(tt.slice(nt));return F?(U.w=E.get(F[0].toLowerCase()),nt+F[0].length):-1}function v(U,tt,nt){var F=c.exec(tt.slice(nt));return F?(U.w=f.get(F[0].toLowerCase()),nt+F[0].length):-1}function N(U,tt,nt){var F=m.exec(tt.slice(nt));return F?(U.m=p.get(F[0].toLowerCase()),nt+F[0].length):-1}function L(U,tt,nt){var F=W.exec(tt.slice(nt));return F?(U.m=w.get(F[0].toLowerCase()),nt+F[0].length):-1}function d(U,tt,nt){return B(U,e,tt,nt)}function x(U,tt,nt){return B(U,n,tt,nt)}function y(U,tt,nt){return B(U,r,tt,nt)}function D(U){return a[U.getDay()]}function A(U){return o[U.getDay()]}function R(U){return l[U.getMonth()]}function I(U){return u[U.getMonth()]}function j(U){return i[+(U.getHours()>=12)]}function P(U){return 1+~~(U.getMonth()/3)}function Q(U){return a[U.getUTCDay()]}function X(U){return o[U.getUTCDay()]}function at(U){return l[U.getUTCMonth()]}function ft(U){return u[U.getUTCMonth()]}function K(U){return i[+(U.getUTCHours()>=12)]}function ot(U){return 1+~~(U.getUTCMonth()/3)}return{format:function(U){var tt=T(U+="",g);return tt.toString=function(){return U},tt},parse:function(U){var tt=H(U+="",!1);return tt.toString=function(){return U},tt},utcFormat:function(U){var tt=T(U+="",C);return tt.toString=function(){return U},tt},utcParse:function(U){var tt=H(U+="",!0);return tt.toString=function(){return U},tt}}}var oi={"-":"",_:" ",0:"0"},kt=/^\s*\d+/,Ys=/^%/,Ps=/[\\^$*+?|[\]().{}]/g;function dt(t,e,n){var r=t<0?"-":"",i=(r?-t:t)+"",o=i.length;return r+(o<n?new Array(n-o+1).join(e)+i:i)}function Ws(t){return t.replace(Ps,"\\$&")}function Ye(t){return new RegExp("^(?:"+t.map(Ws).join("|")+")","i")}function Pe(t){return new Map(t.map((e,n)=>[e.toLowerCase(),n]))}function Hs(t,e,n){var r=kt.exec(e.slice(n,n+1));return r?(t.w=+r[0],n+r[0].length):-1}function Vs(t,e,n){var r=kt.exec(e.slice(n,n+1));return r?(t.u=+r[0],n+r[0].length):-1}function Bs(t,e,n){var r=kt.exec(e.slice(n,n+2));return r?(t.U=+r[0],n+r[0].length):-1}function js(t,e,n){var r=kt.exec(e.slice(n,n+2));return r?(t.V=+r[0],n+r[0].length):-1}function Gs(t,e,n){var r=kt.exec(e.slice(n,n+2));return r?(t.W=+r[0],n+r[0].length):-1}function si(t,e,n){var r=kt.exec(e.slice(n,n+4));return r?(t.y=+r[0],n+r[0].length):-1}function ui(t,e,n){var r=kt.exec(e.slice(n,n+2));return r?(t.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function qs(t,e,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(n,n+6));return r?(t.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function Xs(t,e,n){var r=kt.exec(e.slice(n,n+1));return r?(t.q=r[0]*3-3,n+r[0].length):-1}function Zs(t,e,n){var r=kt.exec(e.slice(n,n+2));return r?(t.m=r[0]-1,n+r[0].length):-1}function li(t,e,n){var r=kt.exec(e.slice(n,n+2));return r?(t.d=+r[0],n+r[0].length):-1}function Ks(t,e,n){var r=kt.exec(e.slice(n,n+3));return r?(t.m=0,t.d=+r[0],n+r[0].length):-1}function ci(t,e,n){var r=kt.exec(e.slice(n,n+2));return r?(t.H=+r[0],n+r[0].length):-1}function Qs(t,e,n){var r=kt.exec(e.slice(n,n+2));return r?(t.M=+r[0],n+r[0].length):-1}function Js(t,e,n){var r=kt.exec(e.slice(n,n+2));return r?(t.S=+r[0],n+r[0].length):-1}function tu(t,e,n){var r=kt.exec(e.slice(n,n+3));return r?(t.L=+r[0],n+r[0].length):-1}function eu(t,e,n){var r=kt.exec(e.slice(n,n+6));return r?(t.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function nu(t,e,n){var r=Ys.exec(e.slice(n,n+1));return r?n+r[0].length:-1}function ru(t,e,n){var r=kt.exec(e.slice(n));return r?(t.Q=+r[0],n+r[0].length):-1}function iu(t,e,n){var r=kt.exec(e.slice(n));return r?(t.s=+r[0],n+r[0].length):-1}function fi(t,e){return dt(t.getDate(),e,2)}function au(t,e){return dt(t.getHours(),e,2)}function ou(t,e){return dt(t.getHours()%12||12,e,2)}function su(t,e){return dt(1+Nt.count(Ot(t),t),e,3)}function qi(t,e){return dt(t.getMilliseconds(),e,3)}function uu(t,e){return qi(t,e)+"000"}function lu(t,e){return dt(t.getMonth()+1,e,2)}function cu(t,e){return dt(t.getMinutes(),e,2)}function fu(t,e){return dt(t.getSeconds(),e,2)}function hu(t){var e=t.getDay();return e===0?7:e}function du(t,e){return dt(xn.count(Ot(t)-1,t),e,2)}function Xi(t){var e=t.getDay();return e>=4||e===0?Se(t):Se.ceil(t)}function mu(t,e){return t=Xi(t),dt(Se.count(Ot(t),t)+(Ot(t).getDay()===4),e,2)}function gu(t){return t.getDay()}function vu(t,e){return dt(Te.count(Ot(t)-1,t),e,2)}function pu(t,e){return dt(t.getFullYear()%100,e,2)}function yu(t,e){return t=Xi(t),dt(t.getFullYear()%100,e,2)}function wu(t,e){return dt(t.getFullYear()%1e4,e,4)}function bu(t,e){var n=t.getDay();return t=n>=4||n===0?Se(t):Se.ceil(t),dt(t.getFullYear()%1e4,e,4)}function _u(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+dt(e/60|0,"0",2)+dt(e%60,"0",2)}function hi(t,e){return dt(t.getUTCDate(),e,2)}function Mu(t,e){return dt(t.getUTCHours(),e,2)}function xu(t,e){return dt(t.getUTCHours()%12||12,e,2)}function ku(t,e){return dt(1+br.count(he(t),t),e,3)}function Zi(t,e){return dt(t.getUTCMilliseconds(),e,3)}function $u(t,e){return Zi(t,e)+"000"}function Tu(t,e){return dt(t.getUTCMonth()+1,e,2)}function Su(t,e){return dt(t.getUTCMinutes(),e,2)}function Cu(t,e){return dt(t.getUTCSeconds(),e,2)}function Du(t){var e=t.getUTCDay();return e===0?7:e}function Eu(t,e){return dt(Gi.count(he(t)-1,t),e,2)}function Ki(t){var e=t.getUTCDay();return e>=4||e===0?Ce(t):Ce.ceil(t)}function zu(t,e){return t=Ki(t),dt(Ce.count(he(t),t)+(he(t).getUTCDay()===4),e,2)}function Fu(t){return t.getUTCDay()}function Ru(t,e){return dt(wn.count(he(t)-1,t),e,2)}function Uu(t,e){return dt(t.getUTCFullYear()%100,e,2)}function Au(t,e){return t=Ki(t),dt(t.getUTCFullYear()%100,e,2)}function Nu(t,e){return dt(t.getUTCFullYear()%1e4,e,4)}function Lu(t,e){var n=t.getUTCDay();return t=n>=4||n===0?Ce(t):Ce.ceil(t),dt(t.getUTCFullYear()%1e4,e,4)}function Iu(){return"+0000"}function di(){return"%"}function mi(t){return+t}function gi(t){return Math.floor(+t/1e3)}var we,Qi;Ou({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function Ou(t){return we=Os(t),Qi=we.format,we.parse,we.utcFormat,we.utcParse,we}function Yu(t){return new Date(t)}function Pu(t){return t instanceof Date?+t:+new Date(+t)}function Ji(t,e,n,r,i,o,a,u,l,s){var h=ji(),c=h.invert,f=h.domain,_=s(".%L"),E=s(":%S"),W=s("%I:%M"),w=s("%I %p"),m=s("%a %d"),p=s("%b %d"),g=s("%B"),C=s("%Y");function z(T){return(l(T)<T?_:u(T)<T?E:a(T)<T?W:o(T)<T?w:r(T)<T?i(T)<T?m:p:n(T)<T?g:C)(T)}return h.invert=function(T){return new Date(c(T))},h.domain=function(T){return arguments.length?f(Array.from(T,Pu)):f().map(Yu)},h.ticks=function(T){var H=f();return t(H[0],H[H.length-1],T??10)},h.tickFormat=function(T,H){return H==null?z:s(H)},h.nice=function(T){var H=f();return(!T||typeof T.range!="function")&&(T=e(H[0],H[H.length-1],T??10)),T?f(xs(H,T)):h},h.copy=function(){return Bi(h,Ji(t,e,n,r,i,o,a,u,l,s))},h}function bn(){return Vi.apply(Ji(Ls,Is,Ot,Xt,xn,Nt,wr,yr,Me,Qi).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function xt(t){return function(){return t}}function ta(t){let e=3;return t.digits=function(n){if(!arguments.length)return e;if(n==null)e=null;else{const r=Math.floor(n);if(!(r>=0))throw new RangeError(`invalid digits: ${n}`);e=r}return t},()=>new Co(e)}function ea(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function na(t){this._context=t}na.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e);break}}};function ra(t){return new na(t)}function ia(t){return t[0]}function aa(t){return t[1]}function Wu(t,e){var n=xt(!0),r=null,i=ra,o=null,a=ta(u);t=typeof t=="function"?t:t===void 0?ia:xt(t),e=typeof e=="function"?e:e===void 0?aa:xt(e);function u(l){var s,h=(l=ea(l)).length,c,f=!1,_;for(r==null&&(o=i(_=a())),s=0;s<=h;++s)!(s<h&&n(c=l[s],s,l))===f&&((f=!f)?o.lineStart():o.lineEnd()),f&&o.point(+t(c,s,l),+e(c,s,l));if(_)return o=null,_+""||null}return u.x=function(l){return arguments.length?(t=typeof l=="function"?l:xt(+l),u):t},u.y=function(l){return arguments.length?(e=typeof l=="function"?l:xt(+l),u):e},u.defined=function(l){return arguments.length?(n=typeof l=="function"?l:xt(!!l),u):n},u.curve=function(l){return arguments.length?(i=l,r!=null&&(o=i(r)),u):i},u.context=function(l){return arguments.length?(l==null?r=o=null:o=i(r=l),u):r},u}function vi(t,e,n){var r=null,i=xt(!0),o=null,a=ra,u=null,l=ta(s);t=typeof t=="function"?t:t===void 0?ia:xt(+t),e=typeof e=="function"?e:xt(e===void 0?0:+e),n=typeof n=="function"?n:n===void 0?aa:xt(+n);function s(c){var f,_,E,W=(c=ea(c)).length,w,m=!1,p,g=new Array(W),C=new Array(W);for(o==null&&(u=a(p=l())),f=0;f<=W;++f){if(!(f<W&&i(w=c[f],f,c))===m)if(m=!m)_=f,u.areaStart(),u.lineStart();else{for(u.lineEnd(),u.lineStart(),E=f-1;E>=_;--E)u.point(g[E],C[E]);u.lineEnd(),u.areaEnd()}m&&(g[f]=+t(w,f,c),C[f]=+e(w,f,c),u.point(r?+r(w,f,c):g[f],n?+n(w,f,c):C[f]))}if(p)return u=null,p+""||null}function h(){return Wu().defined(i).curve(a).context(o)}return s.x=function(c){return arguments.length?(t=typeof c=="function"?c:xt(+c),r=null,s):t},s.x0=function(c){return arguments.length?(t=typeof c=="function"?c:xt(+c),s):t},s.x1=function(c){return arguments.length?(r=c==null?null:typeof c=="function"?c:xt(+c),s):r},s.y=function(c){return arguments.length?(e=typeof c=="function"?c:xt(+c),n=null,s):e},s.y0=function(c){return arguments.length?(e=typeof c=="function"?c:xt(+c),s):e},s.y1=function(c){return arguments.length?(n=c==null?null:typeof c=="function"?c:xt(+c),s):n},s.lineX0=s.lineY0=function(){return h().x(t).y(e)},s.lineY1=function(){return h().x(t).y(n)},s.lineX1=function(){return h().x(r).y(e)},s.defined=function(c){return arguments.length?(i=typeof c=="function"?c:xt(!!c),s):i},s.curve=function(c){return arguments.length?(a=c,o!=null&&(u=a(o)),s):a},s.context=function(c){return arguments.length?(c==null?o=u=null:u=a(o=c),s):o},s}const rn=t=>()=>t;function Hu(t,{sourceEvent:e,target:n,transform:r,dispatch:i}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:i}})}function Pn(t){t.stopImmediatePropagation()}function We(t){t.preventDefault(),t.stopImmediatePropagation()}function Vu(t){return(!t.ctrlKey||t.type==="wheel")&&!t.button}function Bu(){var t=this;return t instanceof SVGElement?(t=t.ownerSVGElement||t,t.hasAttribute("viewBox")?(t=t.viewBox.baseVal,[[t.x,t.y],[t.x+t.width,t.y+t.height]]):[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]):[[0,0],[t.clientWidth,t.clientHeight]]}function pi(){return this.__zoom||Qe}function ju(t){return-t.deltaY*(t.deltaMode===1?.05:t.deltaMode?1:.002)*(t.ctrlKey?10:1)}function Gu(){return navigator.maxTouchPoints||"ontouchstart"in this}function qu(t,e,n){var r=t.invertX(e[0][0])-n[0][0],i=t.invertX(e[1][0])-n[1][0],o=t.invertY(e[0][1])-n[0][1],a=t.invertY(e[1][1])-n[1][1];return t.translate(i>r?(r+i)/2:Math.min(0,r)||Math.max(0,i),a>o?(o+a)/2:Math.min(0,o)||Math.max(0,a))}function oa(){var t=Vu,e=Bu,n=qu,r=ju,i=Gu,o=[0,1/0],a=[[-1/0,-1/0],[1/0,1/0]],u=250,l=go,s=$i("start","zoom","end"),h,c,f,_=500,E=150,W=0,w=10;function m(d){d.property("__zoom",pi).on("wheel.zoom",B,{passive:!1}).on("mousedown.zoom",M).on("dblclick.zoom",b).filter(i).on("touchstart.zoom",v).on("touchmove.zoom",N).on("touchend.zoom touchcancel.zoom",L).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}m.transform=function(d,x,y,D){var A=d.selection?d.selection():d;A.property("__zoom",pi),d!==A?z(d,x,y,D):A.interrupt().each(function(){T(this,arguments).event(D).start().zoom(null,typeof x=="function"?x.apply(this,arguments):x).end()})},m.scaleBy=function(d,x,y,D){m.scaleTo(d,function(){var A=this.__zoom.k,R=typeof x=="function"?x.apply(this,arguments):x;return A*R},y,D)},m.scaleTo=function(d,x,y,D){m.transform(d,function(){var A=e.apply(this,arguments),R=this.__zoom,I=y==null?C(A):typeof y=="function"?y.apply(this,arguments):y,j=R.invert(I),P=typeof x=="function"?x.apply(this,arguments):x;return n(g(p(R,P),I,j),A,a)},y,D)},m.translateBy=function(d,x,y,D){m.transform(d,function(){return n(this.__zoom.translate(typeof x=="function"?x.apply(this,arguments):x,typeof y=="function"?y.apply(this,arguments):y),e.apply(this,arguments),a)},null,D)},m.translateTo=function(d,x,y,D,A){m.transform(d,function(){var R=e.apply(this,arguments),I=this.__zoom,j=D==null?C(R):typeof D=="function"?D.apply(this,arguments):D;return n(Qe.translate(j[0],j[1]).scale(I.k).translate(typeof x=="function"?-x.apply(this,arguments):-x,typeof y=="function"?-y.apply(this,arguments):-y),R,a)},D,A)};function p(d,x){return x=Math.max(o[0],Math.min(o[1],x)),x===d.k?d:new Tn(x,d.x,d.y)}function g(d,x,y){var D=x[0]-y[0]*d.k,A=x[1]-y[1]*d.k;return D===d.x&&A===d.y?d:new Tn(d.k,D,A)}function C(d){return[(+d[0][0]+ +d[1][0])/2,(+d[0][1]+ +d[1][1])/2]}function z(d,x,y,D){d.on("start.zoom",function(){T(this,arguments).event(D).start()}).on("interrupt.zoom end.zoom",function(){T(this,arguments).event(D).end()}).tween("zoom",function(){var A=this,R=arguments,I=T(A,R).event(D),j=e.apply(A,R),P=y==null?C(j):typeof y=="function"?y.apply(A,R):y,Q=Math.max(j[1][0]-j[0][0],j[1][1]-j[0][1]),X=A.__zoom,at=typeof x=="function"?x.apply(A,R):x,ft=l(X.invert(P).concat(Q/X.k),at.invert(P).concat(Q/at.k));return function(K){if(K===1)K=at;else{var ot=ft(K),U=Q/ot[2];K=new Tn(U,P[0]-ot[0]*U,P[1]-ot[1]*U)}I.zoom(null,K)}})}function T(d,x,y){return!y&&d.__zooming||new H(d,x)}function H(d,x){this.that=d,this.args=x,this.active=0,this.sourceEvent=null,this.extent=e.apply(d,x),this.taps=0}H.prototype={event:function(d){return d&&(this.sourceEvent=d),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(d,x){return this.mouse&&d!=="mouse"&&(this.mouse[1]=x.invert(this.mouse[0])),this.touch0&&d!=="touch"&&(this.touch0[1]=x.invert(this.touch0[0])),this.touch1&&d!=="touch"&&(this.touch1[1]=x.invert(this.touch1[0])),this.that.__zoom=x,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(d){var x=ut(this.that).datum();s.call(d,this.that,new Hu(d,{sourceEvent:this.sourceEvent,target:m,transform:this.that.__zoom,dispatch:s}),x)}};function B(d,...x){if(!t.apply(this,arguments))return;var y=T(this,x).event(d),D=this.__zoom,A=Math.max(o[0],Math.min(o[1],D.k*Math.pow(2,r.apply(this,arguments)))),R=At(d);if(y.wheel)(y.mouse[0][0]!==R[0]||y.mouse[0][1]!==R[1])&&(y.mouse[1]=D.invert(y.mouse[0]=R)),clearTimeout(y.wheel);else{if(D.k===A)return;y.mouse=[R,D.invert(R)],Ge(this),y.start()}We(d),y.wheel=setTimeout(I,E),y.zoom("mouse",n(g(p(D,A),y.mouse[0],y.mouse[1]),y.extent,a));function I(){y.wheel=null,y.end()}}function M(d,...x){if(f||!t.apply(this,arguments))return;var y=d.currentTarget,D=T(this,x,!0).event(d),A=ut(d.view).on("mousemove.zoom",P,!0).on("mouseup.zoom",Q,!0),R=At(d,y),I=d.clientX,j=d.clientY;Ti(d.view),Pn(d),D.mouse=[R,this.__zoom.invert(R)],Ge(this),D.start();function P(X){if(We(X),!D.moved){var at=X.clientX-I,ft=X.clientY-j;D.moved=at*at+ft*ft>W}D.event(X).zoom("mouse",n(g(D.that.__zoom,D.mouse[0]=At(X,y),D.mouse[1]),D.extent,a))}function Q(X){A.on("mousemove.zoom mouseup.zoom",null),Si(X.view,D.moved),We(X),D.event(X).end()}}function b(d,...x){if(t.apply(this,arguments)){var y=this.__zoom,D=At(d.changedTouches?d.changedTouches[0]:d,this),A=y.invert(D),R=y.k*(d.shiftKey?.5:2),I=n(g(p(y,R),D,A),e.apply(this,x),a);We(d),u>0?ut(this).transition().duration(u).call(z,I,D,d):ut(this).call(m.transform,I,D,d)}}function v(d,...x){if(t.apply(this,arguments)){var y=d.touches,D=y.length,A=T(this,x,d.changedTouches.length===D).event(d),R,I,j,P;for(Pn(d),I=0;I<D;++I)j=y[I],P=At(j,this),P=[P,this.__zoom.invert(P),j.identifier],A.touch0?!A.touch1&&A.touch0[2]!==P[2]&&(A.touch1=P,A.taps=0):(A.touch0=P,R=!0,A.taps=1+!!h);h&&(h=clearTimeout(h)),R&&(A.taps<2&&(c=P[0],h=setTimeout(function(){h=null},_)),Ge(this),A.start())}}function N(d,...x){if(this.__zooming){var y=T(this,x).event(d),D=d.changedTouches,A=D.length,R,I,j,P;for(We(d),R=0;R<A;++R)I=D[R],j=At(I,this),y.touch0&&y.touch0[2]===I.identifier?y.touch0[0]=j:y.touch1&&y.touch1[2]===I.identifier&&(y.touch1[0]=j);if(I=y.that.__zoom,y.touch1){var Q=y.touch0[0],X=y.touch0[1],at=y.touch1[0],ft=y.touch1[1],K=(K=at[0]-Q[0])*K+(K=at[1]-Q[1])*K,ot=(ot=ft[0]-X[0])*ot+(ot=ft[1]-X[1])*ot;I=p(I,Math.sqrt(K/ot)),j=[(Q[0]+at[0])/2,(Q[1]+at[1])/2],P=[(X[0]+ft[0])/2,(X[1]+ft[1])/2]}else if(y.touch0)j=y.touch0[0],P=y.touch0[1];else return;y.zoom("touch",n(g(I,j,P),y.extent,a))}}function L(d,...x){if(this.__zooming){var y=T(this,x).event(d),D=d.changedTouches,A=D.length,R,I;for(Pn(d),f&&clearTimeout(f),f=setTimeout(function(){f=null},_),R=0;R<A;++R)I=D[R],y.touch0&&y.touch0[2]===I.identifier?delete y.touch0:y.touch1&&y.touch1[2]===I.identifier&&delete y.touch1;if(y.touch1&&!y.touch0&&(y.touch0=y.touch1,delete y.touch1),y.touch0)y.touch0[1]=this.__zoom.invert(y.touch0[0]);else if(y.end(),y.taps===2&&(I=At(I,this),Math.hypot(c[0]-I[0],c[1]-I[1])<w)){var j=ut(this).on("dblclick.zoom");j&&j.apply(this,arguments)}}}return m.wheelDelta=function(d){return arguments.length?(r=typeof d=="function"?d:rn(+d),m):r},m.filter=function(d){return arguments.length?(t=typeof d=="function"?d:rn(!!d),m):t},m.touchable=function(d){return arguments.length?(i=typeof d=="function"?d:rn(!!d),m):i},m.extent=function(d){return arguments.length?(e=typeof d=="function"?d:rn([[+d[0][0],+d[0][1]],[+d[1][0],+d[1][1]]]),m):e},m.scaleExtent=function(d){return arguments.length?(o[0]=+d[0],o[1]=+d[1],m):[o[0],o[1]]},m.translateExtent=function(d){return arguments.length?(a[0][0]=+d[0][0],a[1][0]=+d[1][0],a[0][1]=+d[0][1],a[1][1]=+d[1][1],m):[[a[0][0],a[0][1]],[a[1][0],a[1][1]]]},m.constrain=function(d){return arguments.length?(n=d,m):n},m.duration=function(d){return arguments.length?(u=+d,m):u},m.interpolate=function(d){return arguments.length?(l=d,m):l},m.on=function(){var d=s.on.apply(s,arguments);return d===s?m:d},m.clickDistance=function(d){return arguments.length?(W=(d=+d)*d,m):Math.sqrt(W)},m.tapDistance=function(d){return arguments.length?(w=+d,m):w},m}const kn=t=>(Fe("data-v-f6626337"),t=t(),Re(),t),Xu={class:"tabs"},Zu=["tab-id","onClick"],Ku={class:"control-container"},Qu={class:"button-label"},Ju=kn(()=>S("div",{class:"arrows"},[S("span",null," ▼ ")],-1)),tl=["onMouseover","onClick"],el={class:"title-row"},nl={class:"title"},rl=["onClick"],il={class:"detail-row"},al={class:"time detail"},ol={class:"quality detail"},sl={class:"keyword detail"},ul={class:"topic detail"},ll={key:0,class:"expanded-content"},cl={class:"content-text"},fl={key:1,class:"tab-contents"},hl={key:0,class:"url-container"},dl=["src"],ml=kn(()=>S("i",{class:"fa fa-sticky-note-o"},null,-1)),gl=[ml],vl={class:"input-popup"},pl={class:"button-container"},yl=kn(()=>S("i",{class:"fa fa-check"},null,-1)),wl=[yl],bl=kn(()=>S("i",{class:"fa fa-close"},null,-1)),_l=[bl],Ml={class:"item"},xl={class:"title-row"},kl={class:"title"},$l=["onClick"],Tl={class:"detail-row"},Sl={class:"detail-container"},Cl={class:"detail"},Dl={class:"detail"},El=["onClick"],zl={key:0,class:"expanded-content"},Fl=De({__name:"TheResourceView",props:{data:{}},setup(t){const e=et(null),n=t,r=et(parseFloat(getComputedStyle(document.documentElement).fontSize)),i=()=>{r.value=parseFloat(getComputedStyle(document.documentElement).fontSize)},o=ga(),a=et(!1),u=et(""),l=["列表","文章","笔记"],s=et("time"),h=()=>{s.value=s.value==="time"?"quality":"time"},c=q(()=>{const w=n.data.filter(m=>o.searchQuery.length===0?!0:o.searchQuery.reduce((p,g)=>g[0]==="#"?p&&m.keywords.includes(g.slice(1)):p&&m.title.includes(g),!0)).map(m=>({...m,expanded:!1}));return s.value==="time"?kr(w,(m,p)=>-m.date[0].getTime()+p.date[0].getTime()):kr(w,(m,p)=>p.quality-m.quality)});function f(w){o.selectedPage=w,o.currentTabID=2}const _=q(()=>({[Sn.DAY]:w=>`${w.getFullYear()}年${w.getMonth()+1}月${w.getDate()}日`,[Sn.MONTH]:w=>`${w.getFullYear()}年${w.getMonth()+1}月`,[Sn.YEAR]:w=>`${w.getFullYear()}年`})[o.timeGrainSelected]);function E(){const w=o.notes.length===0?0:o.notes[o.notes.length-1].id+1;o.notes.push({id:w,page:o.selectedPage,content:u.value,time:new Date().toLocaleString()}),a.value=!1,u.value=""}function W(w){w.expanded=!w.expanded,Gn(()=>{})}return Ee(()=>{window.addEventListener("resize",i)}),ze(()=>{window.removeEventListener("resize",i)}),(w,m)=>{const p=ya("RecycleScroller");return Z(),J("div",{ref_key:"resourceView",ref:e,class:"resource-view",style:{position:"absolute"}},[S("div",Xu,[(Z(),J(Dt,null,Et([1,2,3],g=>S("button",{key:g,class:Zt(["tab-button",{active:bt(o).currentTabID===g}]),"tab-id":g,onClick:C=>bt(o).currentTabID=g},lt(l[g-1]),11,Zu)),64))]),ce(S("div",Ku,[S("div",{class:"control-button",onClick:h},[S("span",Qu,lt(s.value==="time"?"时间排序":"质量排序"),1),Ju])],512),[[jn,bt(o).currentTabID===1]]),bt(o).currentTabID===1?(Z(),Bn(bt(va),{key:0,items:c.value,class:"virtual-scroller","min-item-size":3.875*r.value},{default:re(({item:g,index:C,active:z})=>[Xe(bt(wa),{item:g,active:z,"size-dependencies":[g.expanded],"data-index":C,class:"item-wrapper"},{default:re(()=>[S("div",{class:Zt(["item",{highlighted:g.quality>bt(o).qualityThreshold}]),onMouseover:T=>bt(o).hoverPageID=g.id,onMouseleave:m[0]||(m[0]=T=>bt(o).hoverPageID=null),onClick:T=>f(g)},[S("div",el,[S("div",nl,lt(g.title),1),S("div",{class:"arrow",onClick:Ze(T=>W(g),["stop"])},[S("i",{class:Zt(g.expanded?"fa fa-angle-up":"fa fa-angle-down")},null,2)],8,rl)]),S("div",il,[S("div",al,lt("时间:"+_.value(g.date[0])),1),S("div",ol,lt("质量:"+g.quality.toFixed(2)),1),S("div",sl,lt("关键词:"+g.keywords.join(", ")),1),S("div",ul,lt("主题:"+g.topic),1)]),g.expanded?(Z(),J("div",ll,[S("div",cl,lt(g.intro),1)])):Lt("",!0)],42,tl)]),_:2},1032,["item","active","size-dependencies","data-index"])]),_:1},8,["items","min-item-size"])):bt(o).currentTabID===2?(Z(),J("div",fl,[bt(o).selectedPage?(Z(),J("div",hl,[S("iframe",{src:bt(o).selectedPage.url,width:"100%",height:"100%"},null,8,dl),S("button",{class:"floating-button button",onClick:m[1]||(m[1]=g=>a.value=!0)},gl),ce(S("div",vl,[ce(S("textarea",{"onUpdate:modelValue":m[2]||(m[2]=g=>u.value=g),class:"input-textarea",placeholder:"请输入内容..."},null,512),[[pa,u.value]]),S("div",pl,[S("button",{class:"check-button button",onClick:E},wl),S("button",{class:"check-button button",onClick:m[3]||(m[3]=g=>a.value=!1)},_l)])],512),[[jn,a.value]])])):Lt("",!0)])):bt(o).currentTabID===3?(Z(),Bn(p,{items:bt(o).notes,"item-size":3.875*r.value,class:"virtual-scroller note-scroller","key-field":"id",key:bt(o).notes.length},{default:re(({index:g,item:C})=>{var z,T;return[S("div",Ml,[S("div",xl,[S("div",kl,lt((z=C.page)==null?void 0:z.title),1),S("div",{class:"arrow",onClick:Ze(H=>W(C),["stop"])},[S("i",{class:Zt(C.expanded?"fa fa-angle-up":"fa fa-angle-down")},null,2)],8,$l)]),S("div",Tl,[S("div",Sl,[S("div",Cl,lt("保存时间: "+C.time),1),S("div",Dl,lt("主题: "+((T=C.page)==null?void 0:T.topic)),1)]),S("div",{class:"detail delete-button",onClick:Ze(H=>bt(o).notes.splice(g,1),["stop"])},lt("删除"),8,El)]),C.expanded?(Z(),J("div",zl,lt(C.content),1)):Lt("",!0)])]}),_:1},8,["items","item-size"])):Lt("",!0)],512)}}}),Ue=(t,e)=>{const n=t.__vccOpts||t;for(const[r,i]of e)n[r]=i;return n},Ef=Ue(Fl,[["__scopeId","data-v-f6626337"]]),Rl=t=>(Fe("data-v-79e46fae"),t=t(),Re(),t),Ul={key:0,class:"timeline-title-container-container"},Al={class:"timeline-title-container"},Nl=Rl(()=>S("div",{class:"timeline-title-button"},null,-1)),Ll={class:"timeline-title-text"},Il=["height"],Ol=["width","height"],Yl=["transform"],Pl=["x2"],Wl=["transform"],Hl=["transform"],Vl=["y2"],Bl=["x","y","font-size"],jl=["x1","x2","y2"],Gl=["width","height","onClick"],ql=["transform"],Xl=["y2"],Zl=["x","y","font-size"],Kl=["x1","x2","y2"],Ql=["width","height","onClick"],Jl=["transform","onClick"],tc=["x1","x2","y2"],ec=["x2"],nc=["x","y"],rc=["transform"],ic=De({__name:"BaseTimeline",props:{width:{},currentRange:{},selectRange:{},type:{default:"basic"},dynastyType:{default:"basic"},dynastyList:{default:()=>[]},eventList:{default:()=>[]},eraList:{default:()=>[]},enableBrush:{type:Boolean,default:!0},enableZoom:{type:Boolean,default:!0},timeGrain:{default:null},showTitle:{type:Boolean,default:!0},heightScale:{default:1}},emits:["update:currentRange","update:selectRange"],setup(t,{emit:e}){const n=t,r=e,i=O=>{r("update:currentRange",O)},o=O=>{(_.value.round(O[0]).getTime()!==n.selectRange[0].getTime()||_.value.round(O[1]).getTime()!==n.selectRange[1].getTime())&&r("update:selectRange",O)},a=et(parseFloat(getComputedStyle(document.documentElement).fontSize)),u=()=>{a.value=parseFloat(getComputedStyle(document.documentElement).fontSize)},l=n.currentRange,s={basic:["年份"],dynasty:["朝代","年份"],event:["重大事件","年份"],"dynasty event":["重大事件","朝代","年份"]},h={年份:"time-axis",朝代:"dynasty-axes",重大事件:"event-axes"},c=q(()=>Object.fromEntries(Object.entries(s).map(([O,st])=>[O,Ia([0,...st.map(vt=>vt==="朝代"&&n.dynastyType==="era"?b.value:M.value)])]))),f={864e5:O=>`${O.getFullYear()}年${O.getMonth()+1}月${O.getDate()}日`,2592e6:O=>`${O.getFullYear()}年${O.getMonth()+1}月`,31536e6:O=>`${O.getFullYear()}年`},_=q(()=>({864e5:Nt,2592e6:Xt,31536e6:Ot})[g.value]),E=Xt.every(6),W=Xt.every(3),w=Te.every(2),m=Te.every(1),p=new Date().getTimezoneOffset()*60*1e3,g=et(n.timeGrain??864e5),C=q(()=>n.timeGrain===null),z=et(5),T=et(1.25),H=et(.75),B=q(()=>Math.max(.4,Math.min(2,n.heightScale))),M=q(()=>B.value*3.125*a.value),b=q(()=>B.value*4.375*a.value),v=et(200),N=q(()=>c.value[n.type][c.value[n.type].length-1]),L=et(null),d=et(null),x=et(null),y=et(null),D=q(()=>f[g.value]),A=q(()=>G(n.currentRange,z.value)),R=bn().domain([n.currentRange[0],n.currentRange[1]]).range([0,v.value]),I=q(()=>bn().domain([n.currentRange[0],n.currentRange[1]]).range([0,v.value])),j=q(()=>ro(I.value).tickFormat(D.value).tickValues(A.value).tickSize(.4375*B.value*a.value).tickPadding((1.125*B.value-.375)*a.value)),P=ko().extent([[0,0],[v.value,N.value]]).on("start brush",O=>{var st;return(st=O.sourceEvent)==null?void 0:st.stopPropagation()}).on("end",ct),Q=oa().on("zoom",$t).filter(O=>O.type!=="dblclick").scaleExtent([.8,1/0]).translateExtent([[0,0],[v.value,0]]);let X=null,at=null;const ft=O=>c.value[n.type][O],K=O=>I.value(O.end)-I.value(O.start),ot=O=>K(O)/2,U=q(()=>(n.dynastyType==="era"?.78125:1)*B.value*a.value),tt=q(()=>2.84375*B.value*a.value),nt=q(()=>1.125*B.value*a.value),F=q(()=>.75*B.value*a.value),mt=q(()=>1.125*Math.min(B.value,1)*a.value),ht=q(()=>.75*Math.min(B.value,1)*a.value),yt=q(()=>(nt.value-mt.value)/2),wt=q(()=>(F.value-ht.value)/2);function G(O,st){const vt=O[1].getTime()-O[0].getTime();switch(g.value){case 31536e6:return Wt().domain([O[0].getFullYear(),O[1].getFullYear()+1]).ticks(st).map(k=>{const $=new Date(k,0,1);return $.setFullYear(k===0?1:k),$});case 2592e6:{const k=Math.floor(vt/(st*2592e6));return k>4?E.range(E.floor(O[0]),O[1]):k>1?W.range(W.floor(O[0]),O[1]):Xt.range(Xt.floor(O[0]),O[1])}case 864e5:{const k=Math.floor(vt/(st*864e5));return k>10?w.range(m.floor(O[0]),O[1]):k>4?m.range(m.floor(O[0]),O[1]):k>1?Nt.range(Nt.floor(O[0]),O[1]).filter($=>($.getTime()-p-($.getTime()%1e5===0?0:-343e3))%(3*864e5)===0):Nt.range(Nt.floor(O[0]),O[1])}}}function ct(O){var vt;(vt=O.sourceEvent)==null||vt.stopPropagation();const st=O.selection;o(st?[I.value.invert(st[0]),I.value.invert(st[1])].map(_.value.round):[...n.currentRange])}function $t(O){const st=O.transform;i([R.invert(st.invertX(0)),R.invert(st.invertX(v.value))])}function _t(O){const st=Qe.scale(v.value/(R(O[1])-R(O[0]))).translate(-R(O[0]),0);ut(d.value).call(Q.transform,st)}function ie(O,st){ut(y.value).call(P.move,[I.value(O),I.value(st)])}function te(){if(!d.value)return;const O=d.value.querySelectorAll(".event-axis .tick-label");let st=-1/0;O.forEach(vt=>{const k=vt.closest(".event-axis");if(!k)return;const{left:$,right:Y}=vt.getBoundingClientRect();$<st?k.style.display="none":(k.style.display="",st=Y)})}function $n(O){const st=O[1].getTime()-O[0].getTime();switch(g.value){case 31536e6:st<z.value*H.value*2592e6?g.value=864e5:st<z.value*H.value*31536e6&&(g.value=2592e6);break;case 2592e6:st>z.value*T.value*31536e6?g.value=31536e6:st<z.value*H.value*2592e6&&(g.value=864e5);break;case 864e5:st>z.value*T.value*31536e6?g.value=31536e6:st>z.value*T.value*2592e6&&(g.value=2592e6);break}}return zt(()=>[j.value],()=>{ut(L.value).select(".time-axis .d3-axis").call(j.value),y.value&&ut(y.value).call(P.move,[I.value(n.selectRange[0]),I.value(n.selectRange[1])])}),zt(()=>[n.type,n.dynastyType],()=>{Gn(()=>{ut(L.value).select(".time-axis .d3-axis").call(j.value)})}),zt(()=>[N.value,v.value],()=>{y.value&&(P.extent([[0,0],[v.value,M.value]]),ut(y.value).call(P).call(P.move,[I.value(n.selectRange[0]),I.value(n.selectRange[1])])),n.enableZoom&&(Q.translateExtent([[0,0],[v.value,0]]),ut(x.value).call(Q))}),zt(()=>n.timeGrain,()=>{n.timeGrain!==null&&(g.value=n.timeGrain)}),Ee(()=>{if(window.addEventListener("resize",u),zt(()=>C.value,O=>{O?X=zt(()=>n.currentRange,$n,{immediate:!0}):(X==null||X(),X=null)},{immediate:!0}),ut(L.value).select(".time-axis .d3-axis").call(j.value),n.enableZoom&&ut(x.value).call(Q),y.value){const O=ut(y.value);O.call(P),O.on("dblclick.brush",null).on("wheel.brush",null)}at=new ResizeObserver(O=>{const st=O[0].contentRect.width;v.value=st,R.range([0,st])}),at.observe(L.value)}),ba(()=>{Gn(te)}),ze(()=>{window.removeEventListener("resize",u),at==null||at.disconnect()}),(O,st)=>(Z(),J("div",{style:Gt({width:typeof O.width=="number"?`${O.width}px`:O.width}),class:"timeline-container"},[O.showTitle?(Z(),J("div",Ul,[$r(O.$slots,"extra-title",{},void 0,!0),S("div",Al,[(Z(!0),J(Dt,null,Et(s[O.type],(vt,k)=>(Z(),J("div",{key:k,style:Gt({height:(vt==="朝代"&&O.dynastyType==="era"?b.value:M.value)+"px","min-height":(vt==="朝代"&&O.dynastyType==="era"?b.value:M.value)+"px"}),class:"timeline-title"},[Nl,S("div",Ll,lt(vt),1)],4))),128))])])):Lt("",!0),S("div",{class:"timeline-svg-container",ref_key:"svgContainerRef",ref:x},[$r(O.$slots,"extra-axis",{svgWidth:v.value,xScale:I.value,currentGrain:g.value},void 0,!0),(Z(),J("svg",{ref_key:"svgRef",ref:L,class:"timeline-svg",height:N.value},[S("g",{class:"container",ref_key:"containerRef",ref:d},[S("rect",{width:v.value,height:N.value,fill:"transparent",class:"background",onDblclick:st[0]||(st[0]=vt=>_t(bt(l)))},null,40,Ol),(Z(!0),J(Dt,null,Et(s[O.type],(vt,k)=>(Z(),J("g",{key:k,class:Zt(["x-axis",h[vt]]),transform:`translate(0, ${ft(k)})`},[S("line",{x1:0,x2:v.value,y1:"0",y2:"0",class:"axis-line"},null,8,Pl),vt==="年份"?(Z(),J("g",{key:0,class:"d3-axis",transform:`translate(0, ${M.value})`},null,8,Wl)):vt==="朝代"?(Z(),J(Dt,{key:1},[(Z(!0),J(Dt,null,Et(O.dynastyList,($,Y)=>(Z(),J("g",{class:"dynasty-axis",key:Y,transform:`translate(${I.value($.start)}, ${U.value})`},[S("line",{x1:"0",x2:0,y1:"0",y2:nt.value,class:"split-line"},null,8,Vl),S("text",{x:ot($),y:yt.value,class:"axis-lable","font-size":mt.value},lt($.label),9,Bl),S("line",{x1:K($),x2:K($),y1:"0",y2:nt.value,class:"split-line"},null,8,jl),S("rect",{x:"0",y:"0",width:K($),height:nt.value,class:"click-layer",onClick:V=>ie($.start,$.end)},null,8,Gl)],8,Hl))),128)),O.dynastyType==="era"?(Z(!0),J(Dt,{key:0},Et(O.eraList,($,Y)=>(Z(),J("g",{class:"era-axis",key:Y,transform:`translate(${I.value($.start)}, ${tt.value})`},[S("line",{x1:"0",x2:0,y1:"0",y2:F.value,class:"split-line"},null,8,Xl),ce(S("text",{x:ot($),y:wt.value,"font-size":ht.value,class:"axis-lable"},lt($.label),9,Zl),[[jn,K($)>$.label.length*a.value]]),S("line",{x1:K($),x2:K($),y1:"0",y2:F.value,class:"split-line"},null,8,Kl),S("rect",{x:"0",y:"0",width:K($),height:F.value,class:"click-layer",onClick:V=>ie($.start,$.end)},null,8,Ql)],8,ql))),128)):Lt("",!0)],64)):vt==="重大事件"?(Z(!0),J(Dt,{key:2},Et(O.eventList,($,Y)=>(Z(),J("g",{class:"event-axis",key:Y,transform:`translate(${I.value($.start)}, 0)`,onClick:V=>ie($.start,$.end)},[S("line",{x1:ot($),x2:ot($),y1:"0",y2:.4375*B.value*a.value,class:"tick-line"},null,8,tc),S("line",{x1:"0",x2:K($),y1:"0",y2:"0",class:"tick-line"},null,8,ec),S("text",{x:ot($),y:1.5625*B.value*a.value,class:"tick-label","dominant-baseline":"middle","text-anchor":"middle"},lt($.label),9,nc)],8,Jl))),128)):Lt("",!0)],10,Yl))),128))],512),O.enableBrush?(Z(),J("g",{key:0,class:"brush",ref_key:"brushLayerRef",ref:y,transform:`translate(0, ${ft(s[O.type].length-1)})`},null,8,rc)):Lt("",!0)],8,Il))],512)],4))}}),yi=Ue(ic,[["__scopeId","data-v-79e46fae"]]);function sa(t){return typeof t=="function"}function wi(){}var sn=function(t){this.previousValue=t,this.interrupted=!1,this.interruptHandlers=new Set};sn.prototype.throwIfInterrupted=function(){if(this.interrupted)throw new Error},sn.prototype.interrupt=function(){this.interrupted||(this.interrupted=!0,this.interruptHandlers.forEach(function(t){try{t()}catch{}}))},sn.prototype.onInterrupt=function(t){if(this.interrupted&&!this.interruptHandlers.has(t))try{t()}catch{}this.interruptHandlers.add(t)};function _n(t){return function(){return t}}function ua(){return[]}var ac={animationDuration:{type:Number,default:1e3},animationEasing:{type:String,default:"ease"},animationOverlap:{type:Number,default:1},color:{type:[String,Function],default:"Black"},createCanvas:{type:Function,default:function(){return document.createElement("canvas")}},createWorker:{type:Function,default:function(t){return new Worker(URL.createObjectURL(new Blob([t])))}},enterAnimation:{type:[Object,String],default:_n({opacity:0})},fontFamily:{type:[String,Function],default:"serif"},fontSizeRatio:{type:Number,default:0},fontStyle:{type:[String,Function],default:"normal"},fontVariant:{type:[String,Function],default:"normal"},fontWeight:{type:[String,Function],default:"normal"},leaveAnimation:{type:[Object,String],default:_n({opacity:0})},loadFont:{type:Function,default:function(t,e,n,r){return document.fonts.load([e,n,"1px",t].join(" "),r)}},rotation:{type:[Number,Function],default:0},rotationUnit:{type:[String,Function],default:"turn"},spacing:{type:Number,default:0},text:{type:[String,Function],default:""},weight:{type:[Number,Function],default:1},words:{type:Array,default:ua}},oc=_n(null);function fr(t){if(t){var e=typeof t;return e==="object"||e==="function"}return!1}function hr(t){return typeof t=="string"}var sc={animationOptions:function(){var t,e,n,r=this.animationDuration,i=this.enterAnimation,o=this.leaveAnimation;if(fr(i)&&fr(o)){var a=(t=Object.assign({},i,o),e=oc,n={},Object.entries(t).forEach(function(s){var h=s[0],c=s[1];n[h]=e(c,h,t)}),n),u=function(s){Object.assign(s.style,i)},l=function(s,h){setTimeout(function(){Object.assign(s.style,a),setTimeout(h,r)},1)};return{props:{css:!1},on:{beforeAppear:u,appear:l,beforeEnter:u,enter:l,leave:function(s,h){Object.assign(s.style,o),setTimeout(h,r)}}}}return hr(i)&&hr(o)?{props:{duration:r,appear:!0,appearActiveClass:i,enterActiveClass:i,leaveActiveClass:o}}:{}},normalizedAnimationOverlap:function(){var t=this.animationOverlap;return(t=Math.abs(t))<1&&(t=1/t),t},separateAnimationDelay:function(){var t=this.cloudWords;return t.length>1?(this.animationDuration-this.separateAnimationDuration)/(t.length-1):0},separateAnimationDuration:function(){var t=this.cloudWords;if(t.length>0){var e=this.animationDuration,n=this.normalizedAnimationOverlap;return e/Math.min(n,t.length)}return 0}},uc=Array.isArray;function Bt(t){return sa(t)?t:_n(t)}var la=2*Math.PI,lc=la/360;function jt(t){return t===void 0}function ue(t,e){return t.postMessage(e),function(n){return new Promise(function(r,i){var o,a=function(l){var s=l.data;o(),r(s)},u=function(l){var s=l.error;o(),i(s)};o=function(){n.removeEventListener("message",a),n.removeEventListener("error",u)},n.addEventListener("message",a),n.addEventListener("error",u)})}(t)}function bi(t,e,n){return Math.ceil(t*Math.abs(Math.sin(n))+e*Math.abs(Math.cos(n)))}function _i(t,e,n){return Math.ceil(t*Math.abs(Math.cos(n))+e*Math.abs(Math.sin(n)))}function Wn(t,e,n,r,i){return[t,e,n,r+"px",i].join(" ")}function Mi(t,e){return Math.ceil(t/e)*e}function xi(t,e,n){var r=n().getContext("2d");return r.font=e,r.measureText(t).width}var ca=function(t,e,n,r,i,o,a){this.t=t,this.i=e,this.o=n,this.u=r,this.s=i,this.h=o,this.l=a,this.v=1,this.m=0,this.p=0,this.g=0},gt={M:{configurable:!0},S:{configurable:!0},F:{configurable:!0},j:{configurable:!0},O:{configurable:!0},W:{configurable:!0},A:{configurable:!0},B:{configurable:!0},C:{configurable:!0},L:{configurable:!0},_:{configurable:!0},P:{configurable:!0},T:{configurable:!0},N:{configurable:!0},k:{configurable:!0},D:{configurable:!0},H:{configurable:!0},R:{configurable:!0},U:{configurable:!0}};gt.M.get=function(){return this.v},gt.M.set=function(t){this.v!==t&&(this.v=t,this.V=void 0)},gt.S.get=function(){return Wn(this.h,this.s,this.u,this.M,this.o)},gt.F.get=function(){return this.q===void 0&&(this.q=xi(this.t,Wn(this.h,this.s,this.u,1,this.o),this.l)),this.q},gt.j.get=function(){return this.F*this.M},gt.O.get=function(){return this.p*this.M},gt.O.set=function(t){this.p=t/this.M},gt.W.get=function(){return this.g*this.M},gt.W.set=function(t){this.g=t/this.M},gt.A.get=function(){return _i(this.j,this.M,this.i)},gt.B.get=function(){return bi(this.j,this.M,this.i)},gt.C.get=function(){return this.O-this.A/2},gt.L.get=function(){return this.W-this.B/2},gt._.get=function(){return this.m},gt._.set=function(t){this.m!==t&&(this.m=t,this.V=void 0)},gt.P.get=function(){return this.V===void 0&&(this.V=function(t,e,n,r,i,o,a,u,l){var s=Wn(e,n,r,i*=4,o),h=a*i*2,c=h+xi(t,s,l),f=h+i,_=l(),E=_.getContext("2d"),W=Mi(_i(c,f,u),4),w=Mi(bi(c,f,u),4);_.width=W,_.height=w,E.translate(W/2,w/2),E.rotate(u),E.font=s,E.textAlign="center",E.textBaseline="middle",E.fillText(t,0,0),h>0&&(E.miterLimit=1,E.lineWidth=h,E.strokeText(t,0,0));for(var m=E.getImageData(0,0,W,w).data,p=[],g=1/0,C=0,z=1/0,T=0,H=W/4,B=w/4,M=0;M<H;++M)for(var b=0;b<B;++b)t:for(var v=0;v<4;++v)for(var N=0;N<4;++N)if(m[4*(W*(4*b+N)+(4*M+v))+3]){p.push([M,b]),g=Math.min(M,g),C=Math.max(M+1,C),z=Math.min(b,z),T=Math.max(b+1,T);break t}return p.length>0?[p.map(function(L){var d=L[0],x=L[1];return[d-g,x-z]}),C-g,T-z,Math.ceil(H/2)-g,Math.ceil(B/2)-z]:[p,0,0,0,0]}(this.t,this.h,this.s,this.u,this.M,this.o,this._,this.i,this.l)),this.V},gt.T.get=function(){return this.P[0]},gt.N.get=function(){return this.P[1]},gt.k.get=function(){return this.P[2]},gt.D.get=function(){return this.P[3]},gt.H.get=function(){return this.P[4]},gt.R.get=function(){return Math.ceil(this.O)-this.D},gt.R.set=function(t){this.O=t+this.D},gt.U.get=function(){return Math.ceil(this.W)-this.H},gt.U.set=function(t){this.W=t+this.H},Object.defineProperties(ca.prototype,gt);var cc={cloudWords:function(t){this.$emit("update:cloudWords",t)},progress:{handler:function(t){this.$emit("update:progress",t)},deep:!0,immediate:!0}},fc={updateElementSize:function(){var t=this.$el;t&&(this.elementWidth=t.offsetWidth,this.elementHeight=t.offsetHeight)}},hc={name:"VueWordCloud",mixins:[function(t){return{data:function(){var e={};return Object.keys(t).forEach(function(n){e["asyncComputed_trigger_"+n]={}}),e},computed:{},beforeCreate:function(){var e=this,n=new Set;Object.entries(t).forEach(function(r){var i=r[0],o=r[1],a=o.get,u=o.default,l=o.errorHandler;l===void 0&&(l=wi);var s,h=!0;e.$options.computed[i]=function(){return this["asyncComputed_trigger_"+i],this["asyncComputed_promise_"+i],u},e.$options.computed["asyncComputed_promise_"+i]=function(){var c=this;s&&(s.interrupt(),n.delete(s)),h&&(h=!1,sa(u)&&(u=u.call(this)));var f=new sn(u);s=f,n.add(s),new Promise(function(_){_(a.call(c,f))}).then(function(_){f.throwIfInterrupted(),u=_,c["asyncComputed_trigger_"+i]={}}).catch(l)}})}}}({cloudWords:{get:function(t){var e,n=this,r=this,i=r.elementWidth,o=r.elementHeight,a=r.words,u=r.text,l=r.weight,s=r.rotation,h=r.rotationUnit,c=r.fontFamily,f=r.fontWeight,_=r.fontVariant,E=r.fontStyle,W=r.color,w=r.spacing,m=r.fontSizeRatio,p=r.createCanvas,g=r.loadFont,C=r.createWorker;e=m,m=(e=Math.abs(e))>1?1/e:e;var z=function(x){var y=x[0],D=x[1];return y>D?[1,D/y]:D>y?[y/D,1]:[1,1]}([i,o]);if(i>0&&o>0){var T=Bt(u),H=Bt(l),B=Bt(s),M=Bt(h),b=Bt(c),v=Bt(f),N=Bt(_),L=Bt(E),d=Bt(W);return a=a.map(function(x,y){var D,A,R,I,j,P,Q,X,at,ft,K;x&&(hr(x)?R=x:uc(x)?(R=(D=x)[0],I=D[1]):fr(x)&&(R=(A=x).text,I=A.weight,j=A.rotation,P=A.rotationUnit,Q=A.fontFamily,X=A.fontWeight,at=A.fontVariant,ft=A.fontStyle,K=A.color)),jt(R)&&(R=T(x,y,a)),jt(I)&&(I=H(x,y,a)),jt(j)&&(j=B(x,y,a)),jt(P)&&(P=M(x,y,a)),jt(Q)&&(Q=b(x,y,a)),jt(X)&&(X=v(x,y,a)),jt(at)&&(at=N(x,y,a)),jt(ft)&&(ft=L(x,y,a)),jt(K)&&(K=d(x,y,a));var ot=new ca(R,function(){switch(P){case"turn":return j*la;case"deg":return function(U){return U*lc}(j)}return j}(),Q,X,at,ft,p);return Object.assign(ot,{J:x,G:I,I:K}),ot}),Promise.resolve().then(function(){return Promise.all(a.map(function(x){var y=x.o,D=x.h,A=x.u,R=x.t;return g(y,D,A,R)}))}).catch(wi).then(function(){if((a=a.filter(function(P){return P.j>0}).sort(function(P,Q){return Q.G-P.G})).length>0){var x=a[0],y=function(P){return P[Q=P,Q.length-1];var Q}(a),D=x.G,A=y.G;if(A<D){var R=m>0?1/m:A>0?D/A:D<0?A/D:1+D-A;a.forEach(function(P){var Q,X,at;P.M=(Q=P.G,(at=1)+(Q-(X=A))*(R-at)/(D-X))})}a.reduceRight(function(P,Q){return Q.M<2*P?Q.M/=P:(P=Q.M,Q.M=1),Q.K=P},1),a.forEach(function(P){P.M*=4});var I=C(`!function(){"use strict";var r=function(t){self.removeEventListener("message",r);var n,e,a,f,i,u=t.data,o=function(){n={},e=0,a=0,f=0,i=0};o();var s=function(){return Math.ceil((e+a)/2)},v=function(){return Math.ceil((f+i)/2)},c=function(){return{left:s(),top:v(),width:a-e,height:i-f}},l=function(r,t,u){r.forEach((function(r){var o=r[0],s=r[1],v=t+o,c=u+s;n[v+"|"+c]=!0,e=Math.min(v,e),a=Math.max(v+1,a),f=Math.min(c,f),i=Math.max(c+1,i)}))},h=function(r,t,e){return function(r,t,n){var e,a,f=r[0],i=r[1],u=t[0],o=t[1];f>i?(e=1,a=i/f):i>f?(a=1,e=f/i):e=a=1;var s=[u,o];if(n(s))return s;for(var v=u,c=o,l=u,h=o,M=v,d=c;;){u-=e,o-=a,v+=e,c+=a;var m=Math.floor(u),g=Math.floor(o),p=Math.ceil(v),E=Math.ceil(c);if(p>M)for(var L=g;L<E;++L){var x=[p,L];if(n(x))return x}if(E>d)for(var y=p;y>m;--y){var w=[y,E];if(n(w))return w}if(m<l)for(var B=E;B>g;--B){var F=[m,B];if(n(F))return F}if(g<h)for(var b=m;b<p;++b){var j=[b,g];if(n(j))return j}l=m,h=g,M=p,d=E}}(u,[t+s(),e+v()],(function(t){var e=t[0],a=t[1];return function(r,t,e){return r.every((function(r){var a=r[0],f=r[1];return!n[t+a+"|"+(e+f)]}))}(r,e,a)}))};self.postMessage({}),self.addEventListener("message",(function(r){self.postMessage({getBounds:c,put:l,findFit:h,clear:o}[r.data.name].apply(null,r.data.args))}))};self.addEventListener("message",r)}();
`),j={completedWords:0,totalWords:a.length};return Promise.resolve().then(function(){return t.throwIfInterrupted(),n.progress=j,ue(I,z)}).then(function(){t.throwIfInterrupted(),j.completedWords++;var P=Promise.resolve();return a.reduce(function(Q,X,at){return P=P.then(function(){return X.K<Q.K?Promise.resolve().then(function(){return ue(I,{name:"clear"})}).then(function(){var ft=Promise.resolve(),K=Q.K/X.K;return a.slice(0,at).forEach(function(ot){ft=ft.then(function(){return ot.M*=K,ue(I,{name:"put",args:[ot.T,ot.R,ot.U]})})}),ft}):ue(I,{name:"put",args:[Q.T,Q.R,Q.U]})}).then(function(){return X._=w,ue(I,{name:"findFit",args:[X.T,X.R,X.U]})}).then(function(ft){var K=ft[0],ot=ft[1];t.throwIfInterrupted(),j.completedWords++,X.R=K,X.U=ot,X._=0}),X}),P}).then(function(){return ue(I,{name:"put",args:[y.T,y.R,y.U]})}).then(function(){return ue(I,{name:"getBounds"})}).then(function(P){var Q=P.left,X=P.top,at=P.width,ft=P.height;if(at>0&&ft>0){var K=Math.min(i/at,o/ft);a.forEach(function(U){U.O-=Q,U.W-=X,U.M*=K})}var ot=new Set;return a.map(function(U){for(var tt=U.J,nt=U.t,F=U.G,mt=U.i,ht=U.o,yt=U.u,wt=U.s,G=U.h,ct=U.S,$t=U.O,_t=U.W,ie=U.I,te=JSON.stringify([nt,ht,yt,wt,G]);ot.has(te);)te+="!";return ot.add(te),{key:te,word:tt,text:nt,weight:F,rotation:mt,font:ct,color:ie,left:$t,top:_t}})}).finally(function(){I.terminate()}).finally(function(){t.throwIfInterrupted(),n.progress=null})}return[]})}return[]},default:ua}})],props:ac,data:function(){return{elementWidth:0,elementHeight:0,progress:null}},computed:sc,watch:cc,mounted:function(){var t,e,n=this;t=function(){if(n._isDestroyed)return!1;n.updateElementSize()},e=1e3,function(r){var i=function(){for(var o=[],a=arguments.length;a--;)o[a]=arguments[a];return r.call.apply(r,[this,i].concat(o))};return i}(function(r){requestAnimationFrame(function(){t()!==!1&&setTimeout(r,e)})})()},methods:fc,render:function(){var t=this.$slots,e=this.animationEasing,n=this.animationOptions,r=this.cloudWords,i=this.separateAnimationDelay,o=this.separateAnimationDuration;return t=Object.assign({},{default:function(a){return a.text}},t),Le("div",{style:{height:"100%",position:"relative",width:"100%"}},[Le("div",{style:{bottom:"50%",position:"absolute",right:"50%",transform:"translate(50%,50%)"}},r.map(function(a,u){var l=a.color,s=a.font,h=a.left,c=a.rotation,f=a.text,_=a.top,E=a.weight,W=a.word;return Le("transition",Object.assign({},n),[Le("div",{key:u,style:Object.assign({},{left:h+"px",position:"absolute",top:_+"px"},o>0?{animation:[o+"ms",e,i*u+"ms"].join(" "),transition:["all",o+"ms",e,i*u+"ms"].join(" ")}:{})},[Le("div",{style:Object.assign({},{bottom:"50%",color:l,font:s,position:"absolute",right:"50%",transform:["translate(50%,50%)","rotate("+c+"rad)"].join(" "),whiteSpace:"nowrap"},o>0?{transition:["all",o+"ms",e,i*u+"ms"].join(" ")}:{})},[t.default({color:l,font:s,left:h,text:f,top:_,weight:E,word:W})])])])}))])}};const fa=t=>(Fe("data-v-8c9d6a60"),t=t(),Re(),t),dc={class:"double-timeline-container"},mc=fa(()=>S("div",{class:"timeline-title-warper"},[S("div",{class:"timeline-title"},[S("div",{class:"timeline-title-button"}),S("div",{class:"timeline-title-text"},lt("主题"))]),S("div",{class:"timeline-subtitle"},lt("（二级描述）"))],-1)),gc={class:"extra-axis-container"},vc=["height"],pc=["d"],yc=["d"],wc=["width","height"],bc=["x"],_c=["x"],Mc=["x2"],xc=fa(()=>S("div",{class:"timeline-title-warper"},[S("div",{class:"timeline-title"},[S("div",{class:"timeline-title-button"}),S("div",{class:"timeline-title-text"},lt("总览"))])],-1)),kc={width:"100%",height:"5rem",class:"extra-axis-svg"},$c=["d"],Tc=["transform"],Sc=["x2"],Cc=["x"],Dc=["x"],Ec=De({__name:"NewNewTimelineView",props:{width:{},currentRange:{},selectRange:{},currentGrain:{},data:{},qualityThreshold:{},hoverPageId:{},topics:{},dynastyList:{default:()=>[]},eventList:{default:()=>[]},eraList:{default:()=>[]},autoGrain:{type:Boolean,default:!0}},emits:["update:currentRange","update:selectRange","update:currentGrain"],setup(t,{emit:e}){const n=t,r=e,i=et(parseFloat(getComputedStyle(document.documentElement).fontSize)),o=()=>{i.value=parseFloat(getComputedStyle(document.documentElement).fontSize)},a=et(31536e6),u=et(bn()),l=et(bn()),s=q(()=>({864e5:Nt,2592e6:Xt,31536e6:Ot})[a.value]),h=q(()=>n.data.map(M=>({...M,date:M.date.map(s.value.floor)}))),c=q(()=>{const[M,b]=qe(h.value.flatMap(v=>v.date)).map(v=>v.getTime());return[M,b]}),f=q(()=>{const M=zr(h.value.flatMap(v=>v.date).map(v=>v.getTime()),v=>v.length,v=>v),b=new Date(c.value[0]);return Array.from({length:Math.round((c.value[1]-c.value[0])/a.value)+1},(v,N)=>({time:s.value.offset(b,N),count:M.get(s.value.offset(b,N).getTime())||0})).map(v=>({time:s.value.round(new Date(v.time)),count:v.count}))}),_=q(()=>f.value.slice(Math.max(0,s.value.count(f.value[0].time,n.currentRange[0])),s.value.count(f.value[0].time,n.currentRange[1])+2)),E=q(()=>Wt().domain([0,Math.max(Ke(f.value,M=>M.count),1)]).range([5*i.value,0])),W=q(()=>E.value.ticks(4)),w=q(()=>vi().x(M=>u.value(M.time)).y0(5*i.value).y1(M=>E.value(M.count))),m=q(()=>n.topics.map((M,b)=>{const v=new Date(c.value[0]),N=h.value.filter(x=>x.topic===b),L=zr(N.flatMap(x=>x.date.map(y=>({index:s.value.count(v,y),highlight:x.quality>n.qualityThreshold?[x.id]:[]}))),x=>({count:x.length,highlight:x.flatMap(y=>y.highlight)}),x=>x.index),d=Array.from({length:Math.round((c.value[1]-c.value[0])/a.value)+1},(x,y)=>{var D,A;return{time:s.value.offset(v,y),count:((D=L.get(y))==null?void 0:D.count)??0,highlight:((A=L.get(y))==null?void 0:A.highlight)??[]}});return{topic:M,index:b,data:d,dataNum:N.length,highlightNum:N.filter(x=>x.quality>n.qualityThreshold).length}})),p=q(()=>m.value.map(M=>M.data.length?{...M,data:M.data.slice(Math.max(0,s.value.count(M.data[0].time,n.selectRange[0])),s.value.count(M.data[0].time,n.selectRange[1])+2)}:M)),g=q(()=>Wt().domain([0,Math.max(Ke(p.value.flatMap(M=>M.data),M=>M.count),1)]).range([13.75/3*i.value,0])),C=q(()=>vi().x(M=>l.value(M.time)).y0(13.75/3*i.value).y1(M=>g.value(M.count))),z=q(()=>n.topics.map(M=>{if(M.topic!=null){const b=[...new Set(Object.values(M.topic))].sort((N,L)=>N-L),v=new Map;return b.forEach((N,L)=>v.set(N,L+1)),{name:M.name,topic:Object.entries(M.topic).map(N=>[N[0],v.get(N[1])])}}else return{name:M.name,topic:M.name.split(" ").reverse().map((b,v)=>[b,v+1])}}));function T(M){return a.value=M,n.autoGrain&&r("update:currentGrain",M),""}function H(M){return u.value=M,""}function B(M){return l.value=M,""}return Ee(()=>{window.addEventListener("resize",o),n.currentRange[0].getTime()===n.currentRange[1].getTime()&&r("update:currentRange",[new Date(c.value[0]),new Date(c.value[1])])}),ze(()=>{window.removeEventListener("resize",o)}),(M,b)=>(Z(),J("div",dc,[Xe(yi,{width:M.width,"current-range":M.selectRange,"select-range":[new Date,new Date],"enable-zoom":!1,"enable-brush":!1,"time-grain":M.autoGrain?null:M.currentGrain,"show-title":!1,"height-scale":.6,class:"topic-timeline"},{"extra-title":re(()=>[mc]),"extra-axis":re(({svgWidth:v,xScale:N})=>[qn(lt(B(N))+" ",1),S("div",gc,[(Z(!0),J(Dt,null,Et(p.value,(L,d)=>(Z(),J("svg",{width:"100%",height:13.75/3*i.value,key:L.index,class:"extra-axis-svg"},[S("path",{d:C.value(L.data),fill:"#9A8F8E"},null,8,pc),S("path",{d:C.value(L.data.map(x=>({time:x.time,count:x.highlight.length}))),fill:"#BEB7B6"},null,8,yc),(Z(),J("foreignObject",{x:"0",y:"0",width:10*i.value,height:27.5/9*i.value,class:"word-cloud-container"},[Xe(bt(hc),{style:{height:"100%",width:"100%"},words:z.value[d].topic,"font-family":"SourceHanSansCN-Medium",color:"rgb(48,32,27,0.5)"},null,8,["words"])],8,wc)),S("text",{x:v-.3125*i.value,y:"2.291667rem","text-anchor":"end","dominant-baseline":"baseline",class:"timeline-label-text"},lt("主题"+d),9,bc),S("text",{x:v-.3125*i.value,y:"2.291667rem","text-anchor":"end","dominant-baseline":"hanging",class:"timeline-label-text"},lt(L.highlightNum+"/"+L.dataNum),9,_c),S("line",{x1:"0",y1:"4.58333rem",x2:v,y2:"4.58333rem",class:"y-scale-line"},null,8,Mc)],8,vc))),128))])]),_:1},8,["width","current-range","select-range","time-grain"]),Xe(yi,{dynastyList:M.dynastyList,eraList:M.eraList,width:M.width,"event-list":M.eraList,"extra-axis-title":"总览","current-range":M.currentRange,"onUpdate:currentRange":b[0]||(b[0]=v=>r("update:currentRange",v)),"select-range":M.selectRange,"onUpdate:selectRange":b[1]||(b[1]=v=>r("update:selectRange",v)),type:"dynasty","dynasty-type":"era","show-title":!1,"height-scale":.8,"time-grain":M.autoGrain?null:M.currentGrain,class:"main-timeline"},{"extra-title":re(()=>[xc]),"extra-axis":re(({svgWidth:v,xScale:N,currentGrain:L})=>[qn(lt(T(L))+lt(H(N))+" ",1),(Z(),J("svg",kc,[S("path",{d:w.value(_.value),fill:"#9A8F8E"},null,8,$c),(Z(!0),J(Dt,null,Et(W.value.slice(1),d=>(Z(),J("g",{key:d,transform:`translate(0,${E.value(d)})`},[S("line",{x1:0,y1:0,x2:Math.max(v-2*i.value,0),y2:0,class:"y-scale-line"},null,8,Sc),S("text",{x:v,dx:"-0.25rem",y:"0","text-anchor":"end","dominant-baseline":"middle",class:"y-scale-text"},lt(d),9,Cc)],8,Tc))),128)),S("text",{x:v,dx:"-0.25rem",y:"100%",dy:"-0.25rem","text-anchor":"end","dominant-baseline":"baseline",class:"y-scale-text"},lt("(单位: 个)"),8,Dc)]))]),_:1},8,["dynastyList","eraList","width","event-list","current-range","select-range","time-grain"])]))}}),zf=Ue(Ec,[["__scopeId","data-v-8c9d6a60"]]);function zc(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Hn,ki;function Fc(){if(ki)return Hn;ki=1;function t(n,r){var i=0,o;for(o=0;o<n.length;o++){var a=n[o]-r[o];i+=a*a}return Math.sqrt(i)}class e{constructor(){this.kernelFunc=function(r,i){return Math.exp(-1/2*(r*r)/(i*i))},this.iterationCallback=null}cluster(r,i,o){var a=r.slice();this.iterationCallback=o;var u=1,l=0,s=new Array(a.length);for(s.fill(!0);u>e.options.minDistance;){u=0,l+=1;for(var h=0;h<a.length;++h)if(s[h]){var c=a[h],f=c;c=this._shiftPoint(c,r,i);var _=t(c,f);_>u&&(u=_),_<e.options.minDistance&&(s[h]=!1),a[h]=c}this.iterationCallback&&this.iterationCallback(a,l)}return{originalPoints:r,shiftedPoints:a,clusterIndices:this._groupPoints(a)}}setKernetFunc(r){this.kernelFunc=r}_shiftPoint(r,i,o){var a=r.slice();a.fill(0);var u=0,l;for(l=0;l<i.length;l++){var s=i[l],h=t(r,s),c=this.kernelFunc(h,o),f;for(f=0;f<a.length;f++)a[f]+=s[f]*c;u+=c}for(l=0;l<a.length;l++)a[l]/=u;return a}_groupPoints(r){var i=[],o=0,a=[],u;for(u=0;u<r.length;++u){var l=r[u],s=this._findNearestGroup(l,a);s==null?(i[u]=o,a[o]=[l],o++):(i[u]=s,a[s].push(l))}return i}_findNearestGroup(r,i){var o,a=null;for(o=0;o<i.length;++o){var u=this._distanceToGroup(r,i[o]);if(u<e.options.groupDistanceTolerance){a=o;break}}return a}_distanceToGroup(r,i){var o=Number.MAX_VALUE,a;for(a=0;a<i.length;++a){var u=t(r,i[a]);u<o&&(o=u)}return o}}return e.options={minDistance:.001,groupDistanceTolerance:.1},Hn=e,Hn}var Rc=Fc();const Uc=zc(Rc),Ac=t=>(Fe("data-v-4dc58f77"),t=t(),Re(),t),Nc=["aria-expanded"],Lc={class:"cs-selected"},Ic=Ac(()=>S("span",{class:"cs-arrow"},"﹀",-1)),Oc=["aria-activedescendant"],Yc=["id","onClick"],Pc=De({__name:"CustomSelect",props:{options:{},modelValue:{}},emits:["update:modelValue"],setup(t,{emit:e}){const n=t,r=e,i=et(!1),o=et(0),a=q(()=>{const c=n.options.find(f=>f.value===n.modelValue);return c?c.label:"请选择"});function u(){i.value=!i.value}function l(c){r("update:modelValue",n.options[c].value),i.value=!1}function s(c){if(!i.value&&(c.key==="Enter"||c.key===" ")){i.value=!0;return}i.value&&(c.key==="ArrowDown"?o.value=(o.value+1)%n.options.length:c.key==="ArrowUp"?o.value=(o.value-1+n.options.length)%n.options.length:c.key==="Enter"?l(o.value):c.key==="Escape"&&(i.value=!1))}function h(c){c.target.closest(".cs-container")||(i.value=!1)}return Ee(()=>document.addEventListener("click",h)),ze(()=>document.removeEventListener("click",h)),(c,f)=>(Z(),J("div",{class:"cs-container",onClick:u,onKeydown:Ze(s,["stop","prevent"]),role:"combobox","aria-expanded":i.value,"aria-haspopup":!0,tabindex:"0"},[S("span",Lc,lt(a.value),1),Ic,i.value?(Z(),J("ul",{key:0,class:"cs-dropdown",role:"listbox","aria-activedescendant":`opt-${o.value}`},[(Z(!0),J(Dt,null,Et(c.options,(_,E)=>(Z(),J("li",{key:_.value,id:`opt-${E}`,class:Zt(["cs-option",{"is-highlighted":E===o.value}]),role:"option",onClick:Ze(W=>l(E),["stop"])},lt(_.label),11,Yc))),128))],8,Oc)):Lt("",!0)],40,Nc))}}),Wc=Ue(Pc,[["__scopeId","data-v-4dc58f77"]]),en=t=>(Fe("data-v-7b3da11a"),t=t(),Re(),t),Hc={class:"mapboxgl-control-container",style:{height:"100%",width:"100%"}},Vc={class:"mapboxgl-ctrl-top-left"},Bc=en(()=>S("span",{class:"mapboxgl-ctrl-icon","aria-hidden":"true",title:"放大"},null,-1)),jc=[Bc],Gc=en(()=>S("span",{class:"mapboxgl-ctrl-icon","aria-hidden":"true",title:"缩小"},null,-1)),qc=[Gc],Xc=en(()=>S("span",{class:"mapboxgl-ctrl-icon","aria-hidden":"true",title:"还原缩放"},null,-1)),Zc=[Xc],Kc={class:"mapboxgl-ctrl-group mapboxgl-ctrl"},Qc={class:"mapboxgl-ctrl-top-right"},Jc={class:"mapboxgl-ctrl select-wrapper",style:{display:"flex",background:"none","box-shadow":"none","pointer-events":"auto"}},tf={class:"map-container"},ef=en(()=>S("rect",{height:"100%",width:"100%",fill:"transparent"},null,-1)),nf={class:"map"},rf=["d"],af=["d","fill-opacity","stroke-width"],of=["cx","cy","id","onMouseover"],sf=["data-word","x","y","font-size","stroke-width","onMouseenter","onMouseleave","onClick"],uf=en(()=>S("div",{class:"mapboxgl-popup mapboxgl-popup-anchor-bottom",style:{"max-width":"240px",transform:"translate(-50%, -100%)","font-size":"small",position:"fixed",display:"none"}},[S("div",{class:"mapboxgl-popup-tip"}),S("div",{class:"mapboxgl-popup-content"})],-1)),lf=De({__name:"NewGalaxyView",props:{data:{},embeddingList:{},hoverKeyword:{},coordinateFilter:{type:Function},hoverPageID:{}},emits:["update:coordinateFilter","update:hoverPageID"],setup(t,{emit:e}){const n=new Uc,r=t,i=e,o=k=>{i("update:coordinateFilter",k)},a=k=>{i("update:hoverPageID",k)},u=et(null),l=et(0),s=et(0),h=et(0),c=et(0),f=et(parseFloat(getComputedStyle(document.documentElement).fontSize)),_=()=>{f.value=parseFloat(getComputedStyle(document.documentElement).fontSize)};let E=null,W=null;const w=q(()=>[.4*f.value,1.6*f.value]),m={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"},p=et(0),g=q(()=>ft(D.value)),C=q(()=>z(g.value));function z(k){if(k.width/k.height>l.value/s.value){const Y=l.value/k.width*1,V=0,rt=(s.value-k.height*Y)/2,it=-k.x*Y+V,pt=-k.y*Y+rt;return{scale:Y,offsetX:it,offsetY:pt}}else{const Y=s.value/k.height*1,V=(l.value-k.width*Y)/2,rt=0,it=-k.x*Y+V,pt=-k.y*Y+rt;return{scale:Y,offsetX:it,offsetY:pt}}}const T=et(oa()),H=q(()=>{const k=new Map;return x.value.forEach($=>{k.set($.id,$)}),k}),B=new Map([["text_embedding","文本嵌入"],["pure_embedding","文本嵌入"],["time_embedding","时间嵌入"],["concat_embedding","拼接嵌入"],["pure_time_embedding","纯时间嵌入"]]),M=et(null),b=et(null),v=et(null),N=et(null),L=q(()=>Wt().domain([0,1]).range([0,l.value])),d=q(()=>Wt().domain([0,1]).range([0,s.value])),x=q(()=>r.data.map(k=>{let{x:$,y:Y}=k.embedding[p.value].coords;return $=L.value($),Y=d.value(Y),{x:$,y:Y,title:k.title,intro:k.intro,id:k.id,keywords:k.keywords}})),y=q(()=>Wo().x(k=>k.x).y(k=>k.y).size([l.value,s.value]).bandwidth(18).weight(()=>1).thresholds(10)),D=q(()=>y.value(x.value)),A=q(()=>{const k={},$=[];return x.value.forEach(Y=>{Y.keywords.forEach(V=>{k[V]==null&&(k[V]=[]),k[V].push([Y.x,Y.y,Y.id])})}),Object.entries(k).forEach(([Y,V])=>{if(V.length<x.value.length*.01){const rt=V.length,it=Tr(V,Tt=>Tt[0])/rt,pt=Tr(V,Tt=>Tt[1])/rt;$.push({word:Y,count:rt,x:it,y:pt,ids:V.map(Tt=>Tt[2])})}else{const rt=_a(V.map(Ut=>[Ut[0],Ut[1]]),Math.ceil(V.length*.05)),it=n.cluster(rt,.02),pt=Ma(it),Tt={};V.forEach(Ut=>{let ae=1/0,ee=-1;pt.forEach((Ae,Ne)=>{const oe=xa([Ut[0],Ut[1]],Ae);oe<ae&&(ae=oe,ee=Ne)}),Tt[ee]==null&&(Tt[ee]=[]),Tt[ee].push(Ut)}),Object.entries(Tt).forEach(([Ut,ae])=>{const ee=ae.length,Ae=pt[parseInt(Ut)][0],Ne=pt[parseInt(Ut)][1];$.push({word:Y,count:ee,x:Ae,y:Ne,ids:ae.map(oe=>oe[2])})})}}),$.sort((Y,V)=>V.count-Y.count),$}),R=q(()=>{const k=Wt().domain(qe(A.value,rt=>rt.count)).range(w.value),Y=new OffscreenCanvas(1,1).getContext("2d");Y.textAlign="center",Y.textBaseline="middle";const V=w.value[0]*.5;return A.value.map(rt=>{Y.font=`${k(rt.count)+V}px Arial`;const it=Y.measureText(rt.word).width;return{...rt,width:it,height:k(rt.count)+V}})}),I=et(1e3),j=q(()=>{const k=new ka(at.value);let $=0;const Y=[],V=performance.now();for(let it in R.value)if($a(R.value[it],k)||(Y.push(R.value[it]),$++),$>I.value)break;const rt=performance.now();return console.log("Time: "+(rt-V)+"ms"),Y}),P=k=>{st(k.ids.map($=>ut(`#p${$}.point`).node()))},Q=k=>{vt(k.ids.map($=>ut(`#p${$}.point`).node()))},X=k=>{const Y=k.ids.map(pt=>ut(`#p${pt}.point`)),V=qe(Y,pt=>Number(pt.attr("cx"))),rt=qe(Y,pt=>Number(pt.attr("cy"))),it=z({x:V[0],y:rt[0],width:V[1]-V[0],height:rt[1]-rt[0]});ut(M.value).select("svg").transition().duration(500).call(T.value.transform,Qe.translate(it.offsetX,it.offsetY).scale(it.scale))},at=q(()=>R.value.map(k=>({x:k.x-k.width/2,y:k.y-k.height/2,width:k.width,height:k.height})).reduce((k,$)=>k===null?{x:$.x,y:$.y,width:$.width,height:$.height}:{x:Math.min(k.x,$.x),y:Math.min(k.y,$.y),width:Math.max(k.x+k.width,$.x+$.width)-Math.min(k.x,$.x),height:Math.max(k.y+k.height,$.y+$.height)-Math.min(k.y,$.y)},null));function ft(k){const[$,Y,V,rt]=k.reduce((it,pt)=>pt.coordinates.reduce((Tt,Ut)=>Ut[0].reduce(([ae,ee,Ae,Ne],[oe,_r])=>[Math.min(ae,oe),Math.min(ee,_r),Math.max(Ae,oe),Math.max(Ne,_r)],Tt),it),[1/0,1/0,-1/0,-1/0]);return $===1/0?{x:0,y:0,width:l.value,height:s.value}:{x:$,y:Y,width:V-$,height:rt-Y}}const K=Wt().domain([0,.7]).range([.05,.15]),ot=q(()=>Wt().domain([0,5]).range([.05*f.value,.125*f.value]));function U(){const $=ut(M.value).select("svg").select("foreignObject").node();$&&$.parentNode&&$.parentNode.appendChild($)}function tt(){const k=ut(M.value).select("svg"),$=k.select(".map");T.value.on("zoom",Y=>{const V=Y.transform;$.attr("transform",V.toString())}),k.call(T.value)}function nt(){const k=ut(M.value).select("svg"),$=Sr(k.node()),Y=[l.value/2,s.value/2+0],V=$.invert(Y),rt=$.k*1.5,it=Cr(Dr($,rt),Y,V);k.transition().duration(500).call(T.value.transform,it)}function F(){const k=ut(M.value).select("svg"),$=Sr(k.node()),Y=[l.value/2,s.value/2+0],V=$.invert(Y),rt=$.k/1.5,it=Cr(Dr($,rt),Y,V);k.transition().duration(500).call(T.value.transform,it)}function mt(){const k=ut(M.value).select("svg");console.log(s.value,l.value,C.value);const{scale:$,offsetX:Y,offsetY:V}=C.value??{scale:1,offsetX:0,offsetY:0};k.transition().duration(500).call(T.value.transform,Qe.translate(Y,V).scale($))}function ht(){U(),tt()}function yt(){var Tt;const k=ut(M.value).select(".mapboxgl-popup"),$=(Tt=k.node())==null?void 0:Tt.getBoundingClientRect();if(!$)return"bottom";const Y={x:k.style("left")?parseFloat(k.style("left")):0,y:k.style("top")?parseFloat(k.style("top")):0},V=Y.y<$.height,rt=Y.y>s.value-$.height,it=Y.x<$.width/2,pt=Y.x>l.value-$.width/2;if(V)return it?"top-left":pt?"top-right":"top";if(rt){if(it)return"bottom-left";if(pt)return"bottom-right"}return it?"left":pt?"right":"bottom"}function wt(){const k=ut(M.value).select(".mapboxgl-popup"),$=yt();k.style("transform",m[$]??"translate(0%,0%)"),k.attr("class",`mapboxgl-popup mapboxgl-popup-anchor-${$}`)}const G=et(!1),ct=et(null),$t=et(0),_t=et(0),ie=()=>{if(G.value){G.value=!1;return}G.value=!0,ct.value&&ct.value.remove()},te=()=>{ct.value&&(ct.value.remove(),ct.value=null,u.value=null)},$n=k=>{if(!G.value)return;const $=ut(M.value).select("svg").select(".map"),[Y,V]=At(k,$.node());if(!$t.value||!_t.value)$t.value=Y,_t.value=V,ct.value=$.append("rect").classed("select-rect",!0).attr("x",$t.value).attr("y",_t.value).attr("width",0).attr("height",0).attr("fill","#1b2b30").attr("fill-opacity",.3).attr("stroke","#1b2b30");else{const rt=Math.min($t.value,Y),it=Math.max($t.value,Y),pt=Math.min(_t.value,V),Tt=Math.max(_t.value,V);u.value=[L.value.invert(rt),d.value.invert(pt),L.value.invert(it),d.value.invert(Tt)],$t.value=0,_t.value=0,G.value=!1}},O=k=>{if(ct.value){const $=ut(M.value).select("svg").select(".map");if(G.value){const[Y,V]=At(k,$.node()),rt=Y-$t.value,it=V-_t.value;ct.value.attr("width",Math.abs(rt)).attr("height",Math.abs(it)),rt<0&&ct.value.attr("x",Y),it<0&&ct.value.attr("y",V)}}};function st(k){k.forEach($=>{const Y=new MouseEvent("mouseenter",{bubbles:!0,cancelable:!0});$.dispatchEvent(Y)})}function vt(k){k.forEach($=>{const Y=new MouseEvent("mouseleave",{bubbles:!0,cancelable:!0});$.dispatchEvent(Y)})}return Ee(()=>{if(E=new IntersectionObserver(k=>{const Y=k[0].boundingClientRect;c.value=Y.left,h.value=Y.top},{root:null,threshold:[0,1]}),M.value&&E.observe(M.value),W=new ResizeObserver(k=>{const Y=k[0].contentRect;l.value=Y.width,s.value=Y.height}),M.value){W.observe(M.value);const k=M.value.getBoundingClientRect();l.value=k.width,s.value=k.height}window.addEventListener("resize",_),ht(),mt()}),ze(()=>{E&&(E.disconnect(),E=null),window.removeEventListener("resize",_)}),zt(()=>r.hoverPageID,k=>{const $=ut(M.value).select(".mapboxgl-popup"),Y=$.select(".mapboxgl-popup-content");if(k===null)$.style("display","none");else{const V=ut(`#p${k}.point`),rt=H.value.get(k),it=V.node().getBoundingClientRect();$.style("left",`${it.x+it.width/2-c.value}px`).style("top",`${it.y+it.height/2-h.value}px`).style("display","flex"),Y.html(`<h3>${rt.title}</h3><p>${rt.intro}</p>`),wt()}},{immediate:!0}),zt(()=>r.hoverKeyword,(k,$)=>{const Y=ut(N.value);$!=null&&vt(Y.selectAll(`text[data-word="${$}"]`).nodes()),k!=null&&st(Y.selectAll(`text[data-word="${k}"]`).nodes())}),zt(()=>[p.value,u.value],()=>{o(k=>u.value===null?!0:Sa(u.value,k.embedding[p.value].coords))}),(k,$)=>{const Y=Ta("hover-class");return Z(),J("div",{ref_key:"mapView",ref:M},[S("div",Hc,[S("div",Vc,[S("div",{class:"mapboxgl-ctrl mapboxgl-ctrl-group"},[S("button",{class:"mapboxgl-ctrl-zoom-in",type:"button","aria-label":"Zoom in","aria-disabled":"false",onClick:nt},jc),S("button",{class:"mapboxgl-ctrl-zoom-out",type:"button","aria-label":"Zoom out","aria-disabled":"false",onClick:F},qc),S("button",{class:"mapboxgl-ctrl-geolocate",type:"button","aria-label":"Reset North","aria-disabled":"false",title:"reset",onClick:mt},Zc)]),S("div",Kc,[S("button",{class:"mapbox-gl-draw_ctrl-draw-btn mapbox-gl-draw_polygon",title:"框选",onClick:ie,style:Gt({backgroundColor:G.value?"#d3d3d3":"white"})},null,4),S("button",{class:"mapbox-gl-draw_ctrl-draw-btn mapbox-gl-draw_trash",title:"清除",onClick:te})])]),S("div",Qc,[S("div",Jc,[Xe(Wc,{modelValue:p.value,"onUpdate:modelValue":$[0]||($[0]=V=>p.value=V),options:k.embeddingList.map(V=>({label:bt(B).get(V.name)??V.name,value:V.idx}))},null,8,["modelValue","options"])])])]),S("div",tf,[(Z(),J("svg",{height:"100%",width:"100%",onClick:$n,onMousemove:O},[ef,S("g",nf,[S("g",{class:"contours",ref_key:"contoursRef",ref:b},[(Z(!0),J(Dt,null,Et(D.value,(V,rt)=>(Z(),J("g",{class:"contour",key:rt},[S("path",{class:"contour-line",d:ri()(V)},null,8,rf),S("path",{class:"contour-fill",d:ri()(V),"fill-opacity":bt(K)(V.value),"stroke-width":ot.value(V.value)},null,8,af)]))),128))],512),S("g",{class:"points",ref_key:"pointsRef",ref:v},[(Z(!0),J(Dt,null,Et(x.value,(V,rt)=>ce((Z(),J("circle",{key:rt,cx:V.x,cy:V.y,id:"p"+V.id,r:"1",class:"point",onMouseover:it=>a(V.id),onMouseout:$[1]||($[1]=it=>a(null))},null,40,of)),[[Y,"hover"]])),128))],512),ce((Z(),J("g",{class:"wordle",ref_key:"wordleRef",ref:N},[(Z(!0),J(Dt,null,Et(j.value,(V,rt)=>ce((Z(),J("text",{key:rt,"data-word":V.word,x:V.x,y:V.y,"font-size":V.height-w.value[0]*.5,"stroke-width":V.height*.01,onMouseenter:it=>P(V),onMouseleave:it=>Q(V),onClick:it=>X(V),class:"wordle-text"},[qn(lt(V.word),1)],40,sf)),[[Y,"hover"]])),128))])),[[Y,"hover"]])])],32)),uf])],512)}}}),Ff=Ue(lf,[["__scopeId","data-v-7b3da11a"]]),cf=t=>(Fe("data-v-e1844a13"),t=t(),Re(),t),ff={class:"chart-header"},hf={key:0,class:"title-wrapper"},df=["title"],mf={key:0,class:"toggle-buttons"},gf=["onClick"],vf={class:"subheader-wrapper"},pf=["title"],yf=["title"],wf={class:"text-wrapper",style:{"margin-left":"0.5625rem"}},bf={class:"sub-title-unit"},_f=cf(()=>S("div",{class:"divider"},[S("div",{class:"fixed-line line"}),S("div",{class:"fill-line line"})],-1)),Mf=["onClick","onMouseover"],xf=["title"],kf=["val"],$f={class:"item-value"},Tf={class:"chart-axis"},Sf={class:"tick-label"},Cf=De({__name:"KeywordView",props:{height:{},width:{},barData:{},toggleLabels:{default:()=>[]},title:{default:"关键词列表"},lableName:{default:"关键词"},valueName:{default:"出现频次"},unit:{default:"（单位：次）"},hoverKeyword:{}},emits:["update:hoverKeyword"],setup(t,{emit:e}){const n=t,r=q(()=>{const b=Math.min(2,n.barData[0].values.length);return n.toggleLabels.length>2?n.toggleLabels.slice(0,b):n.toggleLabels}),i=e,o=b=>{i("update:hoverKeyword",b)},a=et(parseFloat(getComputedStyle(document.documentElement).fontSize)),u=()=>{a.value=parseFloat(getComputedStyle(document.documentElement).fontSize)},l=et(Date.now()),s=et(null),h=et(0),c=et(0),f=et(-1),_=et(0),E=et([]),W=et(n.barData.map((b,v)=>({id:v,label:b.label,values:b.values,top:!1})).sort((b,v)=>(b.values[_.value]-v.values[_.value])*f.value)),w=q(()=>E.value.concat(W.value.filter(b=>!b.top))),m=q(()=>Ke(n.barData,b=>b.values[_.value])),p=q(()=>Math.min(Math.floor(c.value/(a.value*4)),10)),g=q(()=>z(0,m.value,p.value)),C=q(()=>Wt().domain([0,g.value[g.value.length-1]]).range([0,c.value-6.5*a.value]));function z(b,v,N){const L=(v-b)/Math.max(N,1),d=Math.floor(Math.log10(L)),x=L/Math.pow(10,d),y=x>=Math.sqrt(50)?10:x>=Math.sqrt(10)?5:x>=Math.sqrt(2)?2:1;if(d<0)return Array.from({length:N},(D,A)=>b+A);{const D=Math.pow(10,d)*y;let A=Math.round(b/D),R=Math.round(v/D);return A*D>b&&A--,R*D<v&&R++,Array.from({length:R-A+1},(I,j)=>(A+j)*D)}}function T(b){b.top?(b.top=!1,E.value=E.value.filter(v=>v.id!==b.id)):(b.top=!0,E.value.unshift(b))}function H(b){_.value=b}function B(){f.value===1?f.value=-1:f.value=1}zt(()=>[a],()=>{l.value=Date.now()}),zt(()=>s.value,()=>{if(M&&(M.disconnect(),M=null),s.value){const b=s.value.$el;M=new ResizeObserver(v=>{for(const N of v){const{height:L,width:d}=N.contentRect;h.value=L,c.value=d}}),M.observe(b)}}),zt(()=>[_.value,f.value],()=>{W.value=W.value.sort((b,v)=>(b.values[_.value]-v.values[_.value])*f.value)}),zt(()=>n.barData,()=>{W.value=n.barData.map((b,v)=>({id:v,label:b.label,values:b.values,top:!1})).sort((b,v)=>(b.values[_.value]-v.values[_.value])*f.value)});let M=null;return Ee(()=>{var v;const b=(v=s.value)==null?void 0:v.$el;b&&(M=new ResizeObserver(N=>{for(const L of N){const{height:d,width:x}=L.contentRect;h.value=d,c.value=x}}),M.observe(b),window.addEventListener("resize",u))}),ze(()=>{M&&M.disconnect(),window.removeEventListener("resize",u)}),(b,v)=>(Z(),J("div",{style:Gt({height:typeof b.height=="number"?`${b.height}px`:b.height,width:typeof b.width=="number"?`${b.width}px`:b.width}),class:"keyword-container"},[S("header",ff,[b.title.length>0?(Z(),J("div",hf,[S("div",{class:"chart-title",title:b.title},lt(b.title),9,df),r.value.length>1?(Z(),J("div",mf,[(Z(!0),J(Dt,null,Et(r.value,(N,L)=>(Z(),J("button",{key:L,class:Zt(["toggle-btn",{active:_.value===L}]),onClick:d=>H(L)},lt(N),11,gf))),128))])):Lt("",!0)])):Lt("",!0),S("div",vf,[S("div",{class:"fixed-sub-title sub-title",title:b.lableName},lt(b.lableName),9,pf),S("div",{class:"fill-sub-title sub-title",title:b.valueName},[S("div",wf,[S("div",null,lt(b.valueName),1),S("div",bf,lt(b.unit),1)])],8,yf),S("div",{class:"sort-buttons",onClick:B},[S("div",{class:Zt(["sort-arrow",{active:f.value===1}])},"▲",2),S("div",{class:Zt(["sort-arrow",{active:f.value===-1}])},"▼",2)])]),_f]),(Z(),Bn(bt(Ca),{items:w.value,"item-size":2.1875*a.value,"key-field":"id",class:"chart-body",key:l.value,style:Gt({height:h.value+"px"}),ref_key:"scroller",ref:s},{default:re(({item:N})=>[(Z(),J("div",{class:"bar-item",onClick:L=>T(N),key:N.id,style:Gt({backgroundColor:N.top?"#e5e5e5":""}),onMouseover:L=>o(N.label),onMouseleave:v[0]||(v[0]=L=>o(null))},[S("div",{class:"item-name",title:N.label},lt(N.label),9,xf),S("div",{class:"item-inner",style:Gt({width:C.value(N.values[_.value])+"px","--xoffset":-(c.value-(5.5+2*.3125)*a.value-C.value(N.values[_.value]))+"px"}),val:N.values[_.value]},null,12,kf),S("div",$f,lt(N.values[_.value]),1)],44,Mf))]),_:1},8,["items","item-size","style"])),S("div",Tf,[(Z(!0),J(Dt,null,Et(g.value,(N,L)=>(Z(),J("div",{key:L,class:"axis-tick",style:Gt({left:C.value(N)+"px"})},[S("div",{class:"tick-line",style:Gt({height:h.value+"px"})},null,4),S("div",Sf,lt(N),1)],4))),128))])],4))}}),Rf=Ue(Cf,[["__scopeId","data-v-e1844a13"]]);export{Rf as K,zf as N,Ue as _,Ff as a,Ef as b};
